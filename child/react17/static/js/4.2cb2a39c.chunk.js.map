{"version":3,"sources":["components/formily/module.ts","components/formily/constants.ts","components/formily/basic/common.ts","components/formily/basic/context-wrapper.tsx","components/formily/basic/drop.tsx","components/formily/basic/form-design-reducer.ts","components/formily/basic/drag.tsx","components/formily/setter-pane/register-field/form-item/form-layout.js","components/formily/setter-pane/register-field/form-item/form-item.js","components/formily/setter-pane/register-field/form-item/__builtins__.js","components/formily/setter-pane/register-field/form-item/index.tsx","components/formily/simulator-wrap/field-display.tsx","components/formily/simulator-wrap/index.tsx","components/formily/setter-pane/register-field/void-fields.tsx","components/formily/setter-pane/register-field/range-setting.tsx","components/radio/index.tsx","components/formily/setter-pane/register-field/index.tsx","components/formily/setter-pane/index.tsx","components/formily/basic/perview.tsx","components/formily/basic/provider.tsx","pages/custom-form/context.ts","components/icon/index.ts","pages/custom-form/content-header.tsx","pages/custom-form/content-main.tsx","pages/custom-form/index.tsx"],"names":["IChangeTypeProps","BASE","CHANGE_FORMVO","INIT_FORMDESIGN","PLACE_FIELD","DELETE_FIELD","BATCH_DELETE_FIELD","MOVE_FIELD","SELECT_FIELD","COPY_FIELD","CHANGE_FIELD","CLEAR_FORMDESIGN","exteaAttrs","cloneParams","data","undefined","JSON","parse","stringify","isObject","Object","prototype","toString","call","getFieldPath","currentFieldId","fieldsMap","parIds","currentLayer","length","parId","push","recoverField","originField","targetData","curTemplate","this","fieldInfoTemplate","type","console","error","splitDownKeys","Array","from","key","includes","hasOwnProperty","element","keys","replace","split","realKey","pop","every","el","reduce","acc","next","transformField","fieldInfo","iterativeObject","perKey","newKey","transformFormVo","formVo","supInfo","outerFieldPostions","fieldFunctionContorl","curTransformField","fieldKey","nestedFieldPostions","iterativeMethods","interativeData","map","uniqueId","canDrag","canDel","canCopy","visible","currentFunctionCode","id","items","getKeyFormParser","originData","isArray","value","elements","warn","splitTemplates","templates","fieldSetterTemplate","forEach","item","schemaTemplate","Set","initialValue","newSchema","mapSchema","fieldkey","parser","Parser","hasInitialValue","parserResult","i","add","toJSON","dealWithCustomData","props","field","contorlTrigger","triggerKey","oldFunc","params","Promise","resolve","name","form","values","then","validateResult","schema","callback","Schemaiterator","currentSchema","basePath","FormPath","perCBResult","mapProperties","index","address","concat","result","Schema","assign","singleFieldValidate","options","createSchemaFieldParams","createForm","initialValues","validateFirst","fieldProps","toFieldProps","createParams","createObjectField","createArrayField","createVoidField","createField","display","deleteValuesIn","destroy","onMount","submit","finally","onUnmount","getFieldsMap","state","recoverFieldFunc","iterativeOperation","operationArr","validate","returnSuccess","nestedContainerFieldPostions","entries","filter","r","j","reject","code","messages","allSettled","validateData","status","reason","success","createNewFieldHandle","innerField","ids","otherProps","Math","random","slice","Date","title","FormDesignSupInfo","formDesignId","extendMaskLayers","otherSupInfo","templateData","mounted","dndMaskLayerTemplates","observable","bind","newSupInfo","otherData","unMounted","newData","diffChange","perData","ctxWraps","postions","deleteObjectParams","defaultState","selectedFieldId","dealWithPlace","placeLayerInfo","contentFieldId","dragFieldInfo","dropIndex","operationData","targetIndex","findLastIndex","splice","dealWithCopy","copyField","innerIndex","dealWithMoveOperationData","opreationData","removeField","innerFieldId","removeIndex","initAcc","innerFieldInfo","dealWithMove","dragId","dragContentFieldId","dragIndex","dropContentFieldId","addOperationData","removeOperationData","changeParams","dealWithDelete","fieldId","deleteFieldPostions","indexOf","dealWithBatchDelete","selectFieldParIds","finalPosition","deleteFieldPostion","max","dealWithChange","newFieldInfo","cover","changeField","cloneDeep","clearFieldsMap","FormDesignReducer","constants","newFieldsMap","newState","onFormVoChange","copy","moveResult","moveField","move","delete","batchDelState","deleteIds","select","selectId","defaultRootContext","formDesignPerfixCls","FormDesignRootContext","React","createContext","FormDesignDataContext","FieldOperationsContext","placeField","deleteField","selectField","FormDesignProviderWrapper","InnerComponent","forwardRef","ref","rootContextValue","useMemo","Provider","customFieldAttrWithSetting","customFieldsRules","manualContorlSchema","onFieldChange","onChangeValidateInSetter","coustomPerview","useState","formDesignLifeStatus","useReducer","formDesignDataReducer","dispatch","useEffect","initSupInfo","validateWithScrollSign","CoustomPerView","deleteSupInfo","changeSupInfo","resetSetterPaneValue","resetSetterPaneSchema","useCallback","dataContextValue","formDesignDataDiepatch","formDesignState","placeFieldValidate","createInnerFieldInfo","moveFieldValidate","deleteFieldValidate","copyFieldValidate","createCopyFieldInfo","validateOperation","noValidate","contentInfo","operationInfo","validateFunc","operationField","contentField","log","uniquelySign","templateField","fields","deleteIndex","e","stopPropagation","dispatchParams","isBatchDel","deleteResult","copyFieldId","operationsContextValue","reduceRight","ctxWrap","DragDiv","memo","useDrag","dropEffect","baseDrag","connectDragPreview","document","getElementById","className","cs","DragLayout","children","style","Drag","info","dragProps","useContext","funcMemo","memoized","targetFunc","otherParams","ContentDrop","zIndex","FieldDragWithDrop","isSelected","isDragging","isFirstField","isLastField","locationMarker","hoverClassName","wrapperDeleteField","wrappercopyField","sign","show","onClick","onMouseOver","current","classList","onMouseOut","remove","CopyOutlined","DeleteOutlined","Drop","isDropContent","accept","newSelectField","newDeleteField","newCopyField","none","setLocationMarker","collect","monitor","dragCollectData","connectDrag","getArea","eventPostions","top","height","bottom","y","newLocationMarker","useDrop","drop","dropResult","getDropResult","isOverCurrent","isOver","shallow","draggedId","getItem","right","left","hover","clientOffset","getClientOffset","getBoundingClientRect","dropCollectData","connectDrop","timeCount","setTimeout","clearTimeout","useDnd","TargetComponent","__assign","t","s","n","arguments","p","apply","FormLayoutDeepContext","FormLayoutShallowContext","useFormLayout","__rest","getOwnPropertySymbols","propertyIsEnumerable","__read","o","m","Symbol","iterator","ar","done","ICON_MAP","createElement","CloseCircleOutlined","CheckCircleOutlined","warning","ExclamationCircleOutlined","BaseItem","_a","_b","_c","_d","_e","others","_f","active","setActice","formLayout","_g","_h","_j","_k","_l","_m","_o","_p","_q","_r","_s","_t","_u","_v","_w","_x","_y","_z","layout","colon","labelAlign","labelWrap","labelWidth","wrapperWidth","labelCol","wrapperCol","wrapperAlign","wrapperWrap","fullness","size","inset","asterisk","bordered","feedbackIcon","feedbackLayout","tooltipLayout","tooltipIcon","QuestionCircleOutlined","useFormItemLayout","overflow","setOverflow","containerRef","useRef","contentRef","useLayoutEffect","contentWidth","width","containerWidth","useOverflow","label","addonBefore","addonAfter","feedbackStatus","extra","feedbackText","tooltip","test","labelStyle","wrapperStyle","enableCol","maxWidth","prefixCls","tag","antPrefixCls","usePrefixCls","formatChildren","Popover","autoAdjustOverflow","placement","content","cls","buf","pickDataProps","onFocus","onBlur","labelChildren","Tooltip","align","offset","renderLabelText","renderTooltipIcon","renderLabel","FormItem","connect","mapProps","validateStatus","required","isVoidField","description","text","validating","selfErrors","selfWarnings","selfSuccesses","takeMessage","decorator","pattern","target","entire","span","TextArea","Input","FieldMark","mode","markLayerInfo","setMarkLayerInfo","reaction","transformProps","InnerComponents","SimulatorWrapLayoutContext","SimulatorWrapContext","SuffixFieldDisplay","SuffixFieldWidth","flex","pointerEvents","marginBottom","placeholder","tips","disabled","toLocaleLowerCase","UIComponents","TEXT","TEXTAREA","DATE","block","NUMBER","RADIO","expandHandle","expandFieldsDisplay","UIComponent","FieldUIComponent","FieldDisplay","DefaultNoData","justifyContent","alignItems","FieldGroupContent","fieldGroupData","groupLength","functionContorl","DropFieldGroup","customNoData","DropFieldGroupWithContext","SimulatorWrap","SimulatorWrapLayoutContextValue","SimulatorWrapContextValue","expendFieldSimulate","noData","FormGroup","supContent","SupContent","SideLine","AntdRangePicker","DatePicker","RangePicker","transformValue","v","RangeSetterWithInput","onChange","decimal","cacheValue","setCacheValue","rexExp","RegExp","wapperOnChange","newValue","targetValue","dealWithValue","changeValue","correctionValue","minValue","maxValue","format","Moment","rangePickerConfig","targetConfig","picker","showTime","newValues","isDefinedValue","onCalendarChange","dates","dateStrings","RangeSetter","RenderComponent","typeTitleMap","rangeSetterEeactRangeErrorMsg","fieldTitle","componentProps","suffix","RadioGroup","Radio","Group","RadioCombination","isCompose","checkText","statusTypeChangeEffect","statusInfo","$self","linkageFields","alisa","$form","cacheField","perStatusType","linkageKeys","curValue","getValuesIn","registerValidateRules","rangeSetterValidateRules","rule","ctx","SetterPaneLayoutContext","WrapperComponent","mapPropsParams","func","expandField","WrapperComponentBindSupInfo","createCommonField","InputWithFormily","SelectWithFormily","dataSource","getPopupContainer","InputNumberWithFormily","correctionNumber","baseConfig","formatter","RadioWithFormily","CheckboxWithFormily","Checkbox","composeOpts","checkedOpts","TextAreaWithFormily","RangeSetterWithFormily","FormGroupWithFormily","SideLineWithFormily","Select","InputNumber","validateWithScroll","catch","scrollIntoView","scrollMode","inline","behavior","SetterPane","fieldType","NoData","fakeThisAttr","properties","formCore","setFormCore","cacheCite","createSchema","schemaType","curSupInfo","controlFieldsKey","curFieldInfo","formAction","contorlParams","enum","createFormAction","effects","onFormMount","f","onFieldInputValueChange","onFormInputChange","setFormState","fireImmediately","newFormAction","useFormCoreData","FieldSchemaField","scope","createDefaultScope","$published","published","createSchemaField","oldValue","setValues","pp","np","SetterPaneWithContext","expandFields","components","typeEffect","inheritCode","isNew","base","template","customScope","c","curfieldInfo","SetterPaneLayoutContextValue","layerStyles","position","visibility","DragPerview","useDragLayer","dragItem","currentOffset","getSourceClientOffset","fieldName","iconClass","customPerviewProps","contentHeight","domId","offsetWidth","postionStyle","currentX","x","currentY","clientX","clientY","targetStyle","background","transform","getItemStyles","FormDesignProvider","rootState","dataState","operationFuncs","canRender","scrollToErrorParams","rejectPromise","firstErrorFlieldId","setSelectFieldId","getSelectFieldId","getSelectField","deleteFieldId","addField","depandFieldId","depandField","operationContent","findIndex","changeFieldInfo","newField","resetSetterPane","DndProvider","backend","HTML5Backend","rootContext","formDesignContext","Icon","createFromIconfontCN","scriptUrl","ButtonGroup","buttonSize","setSelectId","cursor","ContentHeader","prefix","Content","Layout","Sider","CustomDataSourceSetter","AssociateDataSourceSetter","NonEditableInfoSetter","DragGroup","flexDirection","padding","reducer","actions","showSetterPane","showSimulatorWrap","json","ContentMain","formDesignRef","theme","autoSize","require","Main","curTemplates","setCurTemplates","borderBottom","copyTemplate","contextValue","Page"],"mappings":"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","file":"static/js/4.2cb2a39c.chunk.js","sourcesContent":["import React, { CSSProperties } from \"react\";\nexport interface IFunctionProps {\n  canDrag?: boolean;\n  canDel?: boolean;\n  canCopy?: boolean;\n  visible?: boolean;\n}\n\nexport interface IPostionInfoProps extends IFunctionProps {\n  id: string;\n}\nexport interface IFormDesignContextProps {\n  outerFieldPostions: IPostionInfoProps[];\n  nestedFieldPostions: { [key: string]: IPostionInfoProps[] };\n  fieldsMap: { [key: string]: any };\n  selectedFieldId: string | null;\n  formDesignId: string;\n  SuffixFieldDisplay?: React.ComponentType;\n  mode?: string;\n  changeField: (fieldId: string, newField: any, cover?: boolean) => void;\n}\n\n//可被drag的内容展示props\nexport interface IDragBtnProps {\n  type: string;\n  canDrag?: boolean;\n  name: string;\n  iconClass: string;\n  showToCustomer?: boolean; //是否展示给用户看\n}\n//基础字段的模板属性\nexport interface IFieldVoInfo {\n  id?: string;\n  type: string;\n  title?: string;\n  tips?: string;\n  required?: boolean;\n  [key: string]: any;\n}\nexport interface IFormVoOperations {\n  placeField: (placeLayerInfo: IFieldVoInfo, dragFieldInfo: IFieldVoInfo, noValidate?: boolean) => Promise<string[]>;\n  moveField: (placeLayerInfo: IFieldVoInfo, dragFieldInfo: IFieldVoInfo, noValidate?: boolean) => void;\n  deleteField: (\n    fieldId: string | string[],\n    contentFieldId: string | null,\n    deleteIndex: number | null,\n    e: any,\n    noValidate?: boolean\n  ) => Promise<boolean>;\n  copyField: (\n    fieldId: string,\n    contentFieldId: null | string,\n    innerIndex: number,\n    e: any,\n    noValidate: boolean\n  ) => Promise<string[]>;\n  selectField: (fieldId: string, e?: any) => void;\n}\n\n//drag容器的props\nexport interface IDragProps {\n  type?: string;\n  canDrag?: boolean;\n  uniquelySign: string | number;\n  title?: string;\n  className?: string;\n  style?: CSSProperties;\n  formDesignPerfixCls?: string;\n}\n\nexport interface IDropProps extends IFunctionProps {\n  fieldType?: string;\n  isDropContent: boolean;\n  type?: string;\n  contentFieldId?: string;\n  fieldId?: string;\n  isSelected?: boolean;\n  hasDelete?: boolean;\n  index?: number;\n  fieldName?: string;\n  nestedLevel?: number;\n  isFirstField?: boolean;\n  isLastField?: boolean;\n  accept?: string | string[];\n}\n\nexport type IFormDesignDataReduceProps = Omit<IFormDesignContextProps, \"changeField\">;\n\nexport interface ICommonProps {\n  className?: string;\n  style?: React.CSSProperties;\n  children?: React.ReactNode;\n  ref?: React.Ref<IFormDesignRef>;\n}\nexport interface IFormDesignRootProps extends ICommonProps {\n  formDesignId?: string;\n  formDesignPerfixCls?: string;\n}\n\nexport enum IChangeTypeProps {\n  add = \"add\",\n  move = \"move\",\n  delete = \"delete\",\n  copy = \"copy\",\n  select = \"select\",\n}\nexport interface IFormDesignDataProps extends ICommonProps {\n  templates: { [key: string]: any };\n  formVo?: IFieldVoInfo[];\n  fieldFunctionContorl?: (fieldInfo: IFieldVoInfo) => IFunctionProps;\n  customFieldAttrWithSetting?: <T>(key: string, attrs: T) => T;\n  customFieldsRules?: (fieldInfo: IFieldVoInfo, key: string, value: any) => Promise<string> | string;\n  manualContorlSchema?: <T extends { componentProps?: any; enum?: any[]; visible?: boolean }>(\n    schemaKey: string,\n    contorlField: T,\n    fieldInfo: any\n  ) => T;\n  onFormVoChange?: (changeType: IChangeTypeProps, fields?: string | string[] | IFieldVoInfo) => void;\n  onFieldChange?: (key: string, value: any) => void;\n  fieldKey?: string;\n  onChangeValidateInSetter?: (key: string, value: any, fieldInfo: any) => Promise<boolean> | boolean;\n  coustomPerview?: React.ComponentType<{ item: { uniquelySign?: string; [k: string]: any } }>;\n  extendMaskLayers?: { [key: string]: { uniquelySign: string; name: string; iconClass: string; [key: string]: any } };\n}\n\nexport interface IDataDeliverProps {\n  formDesignDataDiepatch: React.Dispatch<any>;\n  formDesignState: IFormDesignDataReduceProps;\n  formDesignId: string;\n}\n\nexport interface IFormDesignOperationsProps extends ICommonProps {\n  placeFieldValidate?: (dragFieldInfo: any, placeLayerInfo: any) => boolean;\n  createInnerFieldInfo?: (templateField: IFieldVoInfo, contentField: IFieldVoInfo) => any[] | any | void;\n  moveFieldValidate?: (dragFieldInfo: any, placeLayerInfo: any) => boolean;\n  deleteFieldValidate?: (operationField: any, contentField: any) => string[] | boolean | Promise<string[] | boolean>;\n  copyFieldValidate?: (operationField: any, contentField: any) => boolean;\n  createCopyFieldInfo?: (copyTemplateField: IFieldVoInfo, contentField: IFieldVoInfo) => any | void;\n}\n\nexport type IFormDesignProps = IFormDesignRootProps & IFormDesignDataProps & IFormDesignOperationsProps;\n\nexport interface IFormDesignRef {\n  validate: () => Promise<void>;\n  submit: () => Promise<IFieldVoInfo[]>;\n  getFieldsMap: () => IFieldVoInfo[];\n  setSelectFieldId: (id: string) => void;\n  getSelectFieldId: () => string | null;\n  deleteField: (deleteFieldId: string | string[], noValidate?: boolean) => Promise<boolean>;\n  addField: (uniquelySign: string, depandFieldId?: string | null, noValidate?: boolean) => Promise<string[]>;\n  changeFieldInfo: (fieldId: string, newField: any, cover?: boolean) => void;\n  resetSetterPane: () => void;\n  getSelectField: () => IFieldVoInfo;\n}\n\nexport interface ISimulatorWrapProps {\n  layout?: { labelCol?: number; wrapperCol?: number };\n  mode?: \"web\" | string;\n  SuffixFieldWidth?: number;\n  SuffixFieldDisplay?: React.ComponentType | ((props:any)=>JSX.Element);\n  expendFieldSimulate?: {\n    [key: string]: React.ComponentType;\n  };\n  noData?: React.ReactElement|React.ComponentType;\n}\n\nexport interface ISetterPaneOuterProps {\n  expandFields?: { [key: string]: any };\n  layout?: { labelCol: number; wrapperCol: number; span: number };\n  scope?: { [key: string]: any };\n  NoData?: React.ComponentType;\n  [key: string]: any;\n}\nexport interface ISetterPaneInteralProps extends Omit<ISetterPaneOuterProps, \"expandFields\" | \"layout\" | \"scope\"> {\n  formDesignId: string;\n  selectedFieldId: string;\n  createSchemaFieldParams: any;\n  fieldType: string;\n  fieldsMap: { [key: string]: any };\n  changeField: (fieldId: string, newField: any, cover: boolean) => void;\n}\n","export const STATIC = \"STATIC\";\nexport type STATIC = typeof STATIC;\n\nexport const BASE = \"BASE\";\nexport type BASE = typeof BASE;\n\nexport const CHANGE_FORMVO = \"CHANGE_FORMVO\";\nexport type CHANGE_FORMVO = typeof CHANGE_FORMVO;\n\nexport const INIT_FORMDESIGN = \"INIT_FORMDESIGN\";\nexport type INIT_FORMDESIGN = typeof INIT_FORMDESIGN;\n\nexport const PLACE_FIELD = \"PLACE_FIELD\";\nexport type PLACE_FIELD = typeof PLACE_FIELD;\n\nexport const DELETE_FIELD = \"DELETE_FIELD\";\nexport type DELETE_FIELD = typeof DELETE_FIELD;\n\nexport const BATCH_DELETE_FIELD = \"BATCH_DELETE_FIELD\";\nexport type BATCH_DELETE_FIELD = typeof BATCH_DELETE_FIELD;\n\nexport const MOVE_FIELD = \"MOVE_FIELD\";\nexport type MOVE_FIELD = typeof MOVE_FIELD;\n\nexport const SELECT_FIELD = \"SELECT_FIELD\";\nexport type SELECT_FIELD = typeof SELECT_FIELD;\n\nexport const COPY_FIELD = \"COPY_FIELD\";\nexport type COPY_FIELD = typeof COPY_FIELD;\n\nexport const CHANGE_FIELD = \"CHANGE_FIELD\";\nexport type CHANGE_FIELD = typeof CHANGE_FIELD;\n\nexport const CLEAR_FORMDESIGN = \"CLEAR_FORMDESIGN\";\nexport type CLEAR_FORMDESIGN = typeof CLEAR_FORMDESIGN;\n\nexport const CLEAR_SIMULATOR_WRAP = \"CLEAR_SIMULATOR_WRAP\";\nexport type CLEAR_SIMULATOR_WRAP = typeof CLEAR_SIMULATOR_WRAP;\n","import {\n  IFieldVoInfo,\n  IFormDesignContextProps,\n  IPostionInfoProps,\n} from \"../module\";\nimport { createForm, FormPath } from \"@formily/core\";\nimport { Schema, SchemaKey } from \"@formily/react\";\nimport { observable } from \"@formily/reactive\";\nimport { Parser } from \"@formily/path/esm/parser\";\n// 内部使用属性key 数据还原时清除\nconst exteaAttrs = [\"parId\", \"splitDownKeys\"];\nconst cloneParams = (data: any) =>\n  data === undefined || data === null || typeof data !== \"object\"\n    ? data\n    : JSON.parse(JSON.stringify(data));\nconst isObject = (data: any) =>\n  Object.prototype.toString.call(data) === \"[object Object]\";\n// 字段路径查找方法\nexport const getFieldPath = (\n  currentFieldId: string,\n  fieldsMap: { [key: string]: any }\n) => {\n  if (!currentFieldId) {\n    return [];\n  }\n  const parIds: string[] = [currentFieldId];\n  let currentLayer = fieldsMap[parIds[parIds.length - 1]];\n  while (currentLayer.parId) {\n    parIds.push(currentLayer.parId);\n    currentLayer = fieldsMap[parIds[parIds.length - 1]];\n  }\n  return parIds;\n};\n/**\n * 字段还原\n */\nconst recoverField = function <T extends IFieldVoInfo>(\n  this: any,\n  originField: T\n): T | null {\n  const targetData: any = {};\n  if (!originField || !isObject(originField)) {\n    return null;\n  }\n  const curTemplate = this.fieldInfoTemplate[originField.type];\n  if (!curTemplate) {\n    console.error(`${originField.type} template is not found`);\n  }\n  const splitDownKeys = Array.from(curTemplate?.splitDownKeys || []);\n  for (const key in originField) {\n    if (\n      !exteaAttrs.includes(key) &&\n      Object.prototype.hasOwnProperty.call(originField, key)\n    ) {\n      const element =\n        originField[key] === \"\" ? null : cloneParams(originField[key]);\n      const keys = key.replace(/(\\\"|\\')/g, \"\").split(\">\");\n      const realKey = keys.pop();\n      if (keys.length >= 1) {\n        if (keys.every((el) => splitDownKeys.includes(el))) {\n          const operationData = keys.reduce((acc, next) => {\n            if (!acc[next]) {\n              acc[next] = {};\n            }\n            return acc[next];\n          }, targetData);\n          operationData[realKey!] = element;\n        }\n      } else {\n        targetData[key] = element;\n      }\n    }\n  }\n  return targetData;\n};\n\n/**\n * 单个字段值拆分转化\n * @params fieldInfo 单个字段的各个属性值集合\n */\nconst transformField = function <T extends IFieldVoInfo>(\n  this: any,\n  fieldInfo: T,\n  parId: string | null\n): T | null {\n  const targetData: any = {};\n  if (!fieldInfo || !isObject(fieldInfo)) {\n    return null;\n  }\n  if (parId !== undefined) {\n    targetData.parId = parId;\n  }\n  const curTemplate = this.fieldInfoTemplate[fieldInfo.type];\n  if (!curTemplate) {\n    console.error(`${fieldInfo.type} template is not found`);\n  }\n  const splitDownKeys = Array.from(curTemplate?.splitDownKeys || []);\n  const iterativeObject = (data: any = {}, perKey: string = \"\") => {\n    for (const key in data) {\n      if (Object.prototype.hasOwnProperty.call(data, key)) {\n        const newKey = perKey ? perKey + \">\" + key : key;\n        const element = data[key];\n        if (splitDownKeys.includes(key) && isObject(element)) {\n          iterativeObject(element, newKey);\n        } else {\n          targetData[newKey] = cloneParams(element);\n        }\n      }\n    }\n  };\n  iterativeObject(fieldInfo);\n  return targetData;\n};\n/* 对传入的formVo做数据包装以便渲染 */\nconst transformFormVo = function (\n  this: any,\n  formVo: IFieldVoInfo[],\n  supInfo: any\n): Omit<\n  IFormDesignContextProps,\n  \"fieldsInfo\" | \"changeField\" | \"formDesignId\" | \"selectedFieldId\"\n> {\n  const {\n    fieldFunctionContorl,\n    transformField: curTransformField,\n    fieldKey,\n  } = this;\n  let outerFieldPostions: IPostionInfoProps[] = [];\n  const nestedFieldPostions: { [key: string]: IPostionInfoProps[] } = {};\n  const fieldsMap: { [key: string]: IFieldVoInfo } = {};\n  const iterativeMethods = (\n    interativeData: IFieldVoInfo[],\n    parId: string | null = null\n  ) =>\n    interativeData?.map((el: IFieldVoInfo) => {\n      const uniqueId = \"\" + el[fieldKey];\n      const { canDrag, canDel, canCopy, visible } =\n        fieldFunctionContorl?.(el) || {};\n      const currentFunctionCode = {\n        id: uniqueId,\n        canDrag: canDrag ?? true,\n        canDel: canDel ?? true,\n        canCopy: canCopy ?? true,\n        visible: visible ?? true,\n      };\n      fieldsMap[uniqueId] = currentFunctionCode.visible\n        ? curTransformField(el, parId)\n        : { ...el, parId };\n      if (el.items) {\n        nestedFieldPostions[uniqueId] = iterativeMethods(\n          el.items || [],\n          uniqueId\n        );\n      }\n      return currentFunctionCode;\n    });\n  outerFieldPostions = iterativeMethods(formVo);\n  return {\n    outerFieldPostions,\n    nestedFieldPostions,\n    fieldsMap,\n  };\n};\n\nconst getKeyFormParser = (originData: any) => {\n  originData = Array.isArray(originData) ? originData : [originData];\n  return originData.reduce((acc: any, next: any) => {\n    if (next.type === \"Identifier\") {\n      acc.push(next.value);\n    } else if (next.type === \"DestructorExpression\") {\n      if (next.value?.type === \"ArrayPattern\") {\n        acc.push(...getKeyFormParser(next.value.elements));\n      } else {\n        console.warn(\"parserType\", next.type);\n        console.warn(\"afterType\", next.value.type);\n      }\n    } else {\n      console.warn(\"otherType\", next.type);\n    }\n    return acc;\n  }, []);\n};\n\nconst splitTemplates = (templates: any) => {\n  const fieldInfoTemplate: any = {};\n  const fieldSetterTemplate: any = {};\n  if (templates) {\n    templates.forEach((item: any) => {\n      for (const key in item) {\n        if (Object.prototype.hasOwnProperty.call(item, key)) {\n          const schemaTemplate = item[key];\n          if (schemaTemplate) {\n            fieldInfoTemplate[key] = {\n              splitDownKeys: new Set(),\n              ...(schemaTemplate.initialValue || {}),\n            };\n            fieldSetterTemplate[key] = schemaTemplate;\n            const newSchema = mapSchema(\n              schemaTemplate,\n              (fieldkey, element: Schema & { initialValue?: any }) => {\n                const parser = new Parser(fieldkey as string).parse();\n                const hasInitialValue =\n                  element.initialValue !== undefined &&\n                  element.initialValue !== null;\n                getKeyFormParser(parser).forEach(\n                  (parserResult: string, i: number) => {\n                    const keys = parserResult\n                      .replace(/(\\\"|\\')/g, \"\")\n                      .split(\">\");\n                    if (keys.length > 1) {\n                      keys.pop();\n                      keys.forEach((el) =>\n                        fieldInfoTemplate[key].splitDownKeys.add(el)\n                      );\n                    }\n                    if (\n                      hasInitialValue &&\n                      (!element.type ||\n                        [\"void\", \"array\", \"object\"].includes(element.type!))\n                    ) {\n                      if (Array.isArray(element.initialValue)) {\n                        fieldInfoTemplate[key][parserResult] =\n                          element.initialValue[i];\n                      } else {\n                        fieldInfoTemplate[key][parserResult] =\n                          element.initialValue;\n                      }\n                    }\n                  }\n                );\n                delete element.initialValue;\n              }\n            );\n            fieldSetterTemplate[key] = newSchema.toJSON();\n          }\n        }\n      }\n    });\n  }\n  return { fieldInfoTemplate, fieldSetterTemplate };\n};\n\nconst dealWithCustomData = function (this: any, props: any, field: any) {\n  let { contorlTrigger } = field.data || {};\n  if (contorlTrigger) {\n    contorlTrigger = Array.isArray(contorlTrigger)\n      ? contorlTrigger\n      : [contorlTrigger];\n    contorlTrigger.forEach((triggerKey: string) => {\n      const oldFunc = props[triggerKey];\n      props[triggerKey] = (...params: any[]) => {\n        Promise.resolve(\n          this[`${triggerKey}ValidateInSetter`]?.(\n            field.props.name,\n            params[0],\n            this.recoverField(field.form.values)\n          ) ?? true\n        ).then((validateResult) => {\n          if (validateResult) {\n            oldFunc(...params);\n          }\n        });\n      };\n    });\n  }\n  return { ...props };\n};\n\nexport const mapSchema = (\n  schema: any,\n  callback?: (\n    key: SchemaKey,\n    item: Schema,\n    basePath: FormPath,\n    perCBResult: any\n  ) => any\n) => {\n  schema = new Schema(Object.assign({ type: \"object\" }, schema));\n  const Schemaiterator = (\n    currentSchema: Schema,\n    basePath = new FormPath(\"\"),\n    perCBResult = {}\n  ) => {\n    currentSchema.mapProperties((item, key, index) => {\n      const address = basePath.concat(key);\n      if (key === undefined || key === null) {\n        Schemaiterator(item, basePath);\n      } else {\n        // 回调操作\n        const result = callback?.(key, item, basePath, perCBResult);\n        if (item.type && [\"object\", \"void\"].includes(item.type)) {\n          Schemaiterator(item, address, result);\n        }\n      }\n    });\n  };\n  Schemaiterator(schema);\n  return schema;\n};\n// 单个字段数据层面提交并校验\nexport const singleFieldValidate = (\n  fieldInfo: any,\n  schema: any,\n  supInfo: any\n) => {\n  const { createSchemaFieldParams: options } = supInfo;\n  schema = new Schema(schema);\n  const form = createForm({ initialValues: fieldInfo, validateFirst: true });\n  mapSchema(schema, (key, item, basePath) => {\n    const fieldProps = item.toFieldProps(options);\n    const createParams = Object.assign({}, fieldProps, { name: key, basePath });\n    let field;\n    if (item.type === \"object\") {\n      field = form.createObjectField(createParams);\n    } else if (item.type === \"array\") {\n      field = form.createArrayField(createParams);\n    } else if (item.type === \"void\") {\n      field = form.createVoidField(createParams);\n    } else {\n      field = form.createField(createParams);\n    }\n    if (field) {\n      if (field.display === \"none\") {\n        form.deleteValuesIn(key);\n        field.destroy();\n      }\n    }\n  });\n  form.onMount();\n  return form.submit().finally(() => {\n    form.onUnmount();\n  });\n};\n\nexport const getFieldsMap = (state: any, recoverFieldFunc: any) => {\n  const { outerFieldPostions, nestedFieldPostions, fieldsMap } = state;\n  const iterativeOperation = (operationArr: any[]) =>\n    operationArr.reduce((acc, { id, visible }) => {\n      let element = fieldsMap[id];\n      if (visible) {\n        element = recoverFieldFunc(element);\n        if (nestedFieldPostions[id]) {\n          element.items = iterativeOperation(nestedFieldPostions[id]);\n        }\n        acc.push(element);\n      }\n      return acc;\n    }, []);\n  return iterativeOperation(outerFieldPostions);\n};\n\nexport const validate = (\n  state: any,\n  supInfo: any,\n  returnSuccess: boolean = false\n) => {\n  const { fieldsMap, outerFieldPostions, nestedContainerFieldPostions } = state;\n  const { fieldSetterTemplate } = supInfo;\n  const result = Object.entries(fieldsMap).reduce(\n    (acc: any[], [key, fieldInfo]: any) => {\n      if (!fieldInfo) {\n        return acc;\n      } else {\n        const parId = fieldInfo?.parId;\n        const { visible } = (\n          parId ? nestedContainerFieldPostions[parId] : outerFieldPostions\n        ).filter((el: any) => el.id === key)[0];\n        const schema = fieldSetterTemplate[fieldInfo.type] ?? null;\n        if (!visible) {\n          acc.push([key, fieldInfo]);\n        } else if (schema) {\n          acc.push(\n            singleFieldValidate(fieldInfo, schema, supInfo).then(\n              (r) => [key, r],\n              (j) => {\n                throw [key, j];\n              }\n            )\n          );\n        } else {\n          acc.push(\n            Promise.reject([\n              key,\n              [\n                {\n                  code: \"schemaError\",\n                  messages: fieldInfo.type\n                    ? `${key}字段类型为不存在`\n                    : `${key}的类型为${fieldInfo.type}的schema缺失`,\n                },\n              ],\n            ])\n          );\n        }\n      }\n      return acc;\n    },\n    []\n  );\n  return Promise.allSettled(result).then((validateData) => {\n    const validateResult = validateData.reduce(\n      (acc: { error: any[]; success: any }, { status, value, reason }: any) => {\n        if (status === \"rejected\") {\n          acc.error.push({ [reason[0]]: reason[1] });\n        } else {\n          acc.success[value[0]] = value[1];\n        }\n        return acc;\n      },\n      { error: [], success: {} }\n    );\n    if (validateResult.error.length) {\n      throw validateResult.error;\n    } else if (returnSuccess) {\n      return validateResult.success;\n    }\n  });\n};\n\nexport const submit = (state: any, supInfo: any) =>\n  validate(state, supInfo, true).then((fieldsMap: any) => {\n    const { outerFieldPostions, nestedFieldPostions } = state;\n    const iterativeOperation = (operationArr: any[]) =>\n      operationArr.reduce((acc, { id, visible }) => {\n        const element = visible\n          ? supInfo.recoverField(fieldsMap[id])\n          : fieldsMap[id];\n        if (nestedFieldPostions[id]) {\n          element.items = iterativeOperation(nestedFieldPostions[id]);\n        }\n        acc.push(element);\n        return acc;\n      }, []);\n    return iterativeOperation(outerFieldPostions);\n  });\n\n// 前置操作添加唯一id\nexport const createNewFieldHandle = (innerField: any, supInfo: any) => {\n  const { fieldInfoTemplate, fieldKey } = supInfo;\n  const ids: string[] = [];\n  const fields = (Array.isArray(innerField) ? innerField : [innerField]).map(\n    (element: any) => {\n      const { items, ...otherProps } = element;\n      const id =\n        element[fieldKey] ?? Math.random().toString(36).slice(-8) + +new Date();\n      const { title } = fieldInfoTemplate[otherProps.type] || {};\n      // 创建的时候清除 title id\n      const targetData: any = {\n        ...otherProps,\n        id,\n        [fieldKey]: id,\n        isNew: true,\n        title,\n      };\n      if (items && Array.isArray(items)) {\n        targetData.items = createNewFieldHandle(items, fieldInfoTemplate);\n      }\n      ids.push(id);\n      return targetData;\n    }\n  );\n  return [fields, ids];\n};\n\n\nexport class FormDesignSupInfo {\n  static [key:string]:any\n  static initSupInfo(formDesignId: string, supInfo: any = {}) {\n    const {\n      fieldFunctionContorl,\n      templates,\n      extendMaskLayers,\n      ...otherSupInfo\n    } = supInfo;\n    const templateData = splitTemplates(templates);\n    this[formDesignId] = {\n      mounted: true,\n      fieldFunctionContorl,\n      ...otherSupInfo,\n      ...templateData,\n      dndMaskLayerTemplates: observable(extendMaskLayers || {}),\n      extendMaskLayers,\n    };\n    Object.assign(this[formDesignId], {\n      transformField: transformField.bind(this[formDesignId]),\n      recoverField: recoverField.bind(this[formDesignId]),\n      transformFormVo: transformFormVo.bind(this[formDesignId]),\n      dealWithCustomData: dealWithCustomData.bind(this[formDesignId]),\n    });\n  }\n  static changeSupInfo(formDesignId: string, newSupInfo: any = {}) {\n    if (this[formDesignId]) {\n      const { mounted, unMounted, ...otherData } = this[formDesignId];\n      // this[formDesignId].cache = (this[formDesignId].cache || []).concat(cloneDeep(otherData));\n      const newData = FormDesignSupInfo.diffChange(otherData, newSupInfo);\n      Object.assign(this[formDesignId], newData);\n    }\n  }\n\n  static deleteSupInfo(formDesignId: string) {\n    if (this[formDesignId]) {\n      Object.assign(this[formDesignId], { unMounted: true });\n    }\n  }\n\n  static diffChange(perData: any, newData: any) {\n    const { templates, splitDownKeys, dndMaskLayerTemplates, ...otherProps } =\n      newData;\n    const targetData: any = otherProps;\n    if (templates && perData.templates !== templates) {\n      Object.assign(targetData, splitTemplates(templates));\n    }\n    return targetData;\n  }\n}\n","import React from 'react'\nimport { cloneDeep, uniqueId } from 'lodash'\nimport { observable } from '@formily/reactive'\nimport { IFormDesignContextProps, IFormDesignRootProps, IFormVoOperations, IFormDesignDataProps, IFormDesignOperationsProps, IDataDeliverProps, IFormDesignProps, ICommonProps, IFormDesignRef } from '../module'\nimport formDesignDataReducer, { defaultState } from './form-design-reducer'\nimport { createNewFieldHandle, FormDesignSupInfo } from './common'\nimport * as constants from '../constants'\n/* form design style ctx */\nconst defaultRootContext = { formDesignPerfixCls: \"mortale-form-design\", formDesignId: \"\" }\n\nexport const FormDesignRootContext = React.createContext<IFormDesignRootProps>(defaultRootContext)\n\nconst RootContextWrapper = (InnerComponent: React.ComponentType<IFormDesignRootProps>) => {\n  return React.forwardRef<IFormDesignRef, IFormDesignRootProps>((props, ref) => {\n    const { formDesignPerfixCls, ...otherProps } = props\n    const rootContextValue = React.useMemo(() => {\n      const targetData = { ...defaultRootContext }\n      if (formDesignPerfixCls) {\n        targetData.formDesignPerfixCls = formDesignPerfixCls\n      }\n      targetData.formDesignId = uniqueId(`${targetData.formDesignPerfixCls}-`)\n      return targetData\n    }, [formDesignPerfixCls])\n\n    return <FormDesignRootContext.Provider value={rootContextValue}>\n      <InnerComponent\n        {...otherProps}\n        {...rootContextValue}\n        ref={ref} />\n    </FormDesignRootContext.Provider>\n  })\n}\n\n/* form design data ctx */\nexport const FormDesignDataContext = React.createContext<IFormDesignContextProps>(defaultState as any)\n\nconst dataContextWrapper = (InnerComponent: React.ComponentType<Omit<IFormDesignDataProps, \"templates\"> & IDataDeliverProps>) => {\n  // 校验是否结束需要滚动到错误位置\n  return React.forwardRef<IFormDesignRef, IFormDesignDataProps & { formDesignId: string }>((props, ref) => {\n    const { formVo, templates, fieldFunctionContorl, formDesignId, customFieldAttrWithSetting, customFieldsRules, manualContorlSchema, onFormVoChange, onFieldChange, onChangeValidateInSetter, extendMaskLayers, fieldKey = \"id\", coustomPerview, ...otherProps } = props\n    // formDesign 状态\n    const [formDesignLifeStatus] = React.useState({ mounted: false, unMounted: false })\n    const [state, dispatch] = React.useReducer(formDesignDataReducer, cloneDeep(defaultState))\n\n    React.useEffect(() => {\n      formDesignLifeStatus.mounted = true\n      Promise.resolve().then(() => {\n        FormDesignSupInfo.initSupInfo(formDesignId, {\n          fieldFunctionContorl,\n          customFieldAttrWithSetting,\n          templates,\n          customFieldsRules,\n          validateWithScrollSign: observable.ref(\"\"),\n          manualContorlSchema,\n          onFormVoChange,\n          onFieldChange,\n          onChangeValidateInSetter,\n          fieldKey,\n          CoustomPerView: coustomPerview,\n          extendMaskLayers\n        })\n        dispatch({ type: constants.INIT_FORMDESIGN, formDesignId })\n      }).finally(() => {\n        // TODO mount\n        if (formVo?.length) {\n          dispatch({ type: constants.CHANGE_FORMVO, formVo })\n        }\n      })\n      return () => {\n        Promise.resolve().then(() => {\n          FormDesignSupInfo.deleteSupInfo(formDesignId)\n          formDesignLifeStatus.unMounted = true\n          dispatch({ type: constants.CLEAR_FORMDESIGN })\n        }).finally(() => {\n          // TODO unmount\n        })\n      }\n    }, [])\n    // 修改FormDesign对应formDesignId的静态数据（此类数据改变不需要引起视图的刷新，如果需要需要走其他操作）\n    React.useEffect(() => {\n      if (formDesignLifeStatus.mounted) {\n        FormDesignSupInfo.changeSupInfo(formDesignId, {\n          fieldFunctionContorl,\n          customFieldAttrWithSetting,\n          customFieldsRules,\n          templates,\n          manualContorlSchema,\n          onFormVoChange,\n          onFieldChange,\n          CoustomPerView: coustomPerview\n        })\n      }\n    }, [templates, fieldFunctionContorl, customFieldAttrWithSetting, customFieldsRules, manualContorlSchema, onFormVoChange, onFieldChange, coustomPerview])\n    // 设置formVo\n    React.useEffect(() => {\n      const supInfo = FormDesignSupInfo[formDesignId]\n      if (supInfo) {\n        dispatch({ type: constants.CHANGE_FORMVO, formVo })\n      }\n      if (state.selectedFieldId) {\n        if (supInfo?.resetSetterPaneValue) {\n          supInfo.resetSetterPaneValue.value = supInfo.resetSetterPaneValue.value + 1\n        }\n        if (supInfo?.resetSetterPaneSchema) {\n          supInfo.resetSetterPaneSchema.value = supInfo.resetSetterPaneSchema.value + 1\n        }\n      }\n    }, [formVo])\n    // 修改单个字段的属性\n    const changeField = React.useCallback((fieldId:string, newFieldInfo:string, cover:boolean = false) => {\n      dispatch({ type: constants.CHANGE_FIELD, fieldId, newFieldInfo, cover })\n    }, [])\n\n    const dataContextValue = React.useMemo(() => ({ ...state, changeField }), [state, changeField])\n\n    return <FormDesignDataContext.Provider value={dataContextValue}>\n      <InnerComponent {...otherProps}\n        formDesignDataDiepatch={dispatch}\n        formDesignState={state}\n        formDesignId={formDesignId}\n        ref={ref} />\n    </FormDesignDataContext.Provider>\n  })\n}\n\n/* field operations ctx */\nexport const FieldOperationsContext = React.createContext<IFormVoOperations>({\n  placeField: () => Promise.resolve([]),\n  moveField: () => { },\n  deleteField: () => Promise.resolve(true),\n  copyField: () => Promise.resolve([]),\n  selectField: () => { }\n})\n\nconst operationsContextWrapper = (InnerComponent: React.ComponentType<ICommonProps>) => {\n  return React.forwardRef<IFormDesignRef, IFormDesignOperationsProps & IDataDeliverProps>((props, ref) => {\n    const { formDesignState, formDesignDataDiepatch, placeFieldValidate, createInnerFieldInfo, moveFieldValidate, deleteFieldValidate, copyFieldValidate, createCopyFieldInfo, formDesignId, ...otherProps } = props\n\n    const validateOperation = React.useCallback((noValidate:any, contentInfo:any, operationInfo:any, validateFunc:any) => {\n      const supInfo = FormDesignSupInfo[formDesignId]\n      const operationField = supInfo.recoverField?.(formDesignState.fieldsMap[operationInfo.id])\n      const contentField = supInfo.recoverField?.(formDesignState.fieldsMap[contentInfo.id])\n      return Promise.resolve(noValidate || (validateFunc?.({ ...operationField, ...operationInfo }, { ...contentField, ...contentInfo }) ?? true)).then((validateResult) => ({\n        validateResult, operationField,\n        contentField\n      }))\n    }, [])\n\n    // 放置事件\n    const placeField = React.useCallback(({ type: dropType, ...placeLayerInfo }: any, { type: dragType, ...dragFieldInfo }: any, noValidate: boolean = false) => {\n      const supInfo = FormDesignSupInfo[formDesignId]\n      // 校验\n      return Promise.resolve(validateOperation(noValidate, placeLayerInfo, dragFieldInfo, placeFieldValidate)).then(({ validateResult, operationField, contentField }) => {\n        if (validateResult) {\n          // 创建新字段内容\n          console.log(supInfo.fieldInfoTemplate, dragFieldInfo.uniquelySign)\n          const { splitDownKeys, ...templateField } = cloneDeep(supInfo.fieldInfoTemplate[dragFieldInfo.uniquelySign])\n          if (!templateField) {\n            console.error(`${dragFieldInfo.uniquelySign}类型字段不存在`);\n          }\n          return Promise.resolve(createInnerFieldInfo?.(templateField, contentField) || templateField).then((innerField) => {\n            const [fields, ids] = createNewFieldHandle(innerField, supInfo);\n            formDesignDataDiepatch({ type: constants.PLACE_FIELD, innerField: fields, placeLayerInfo, dragFieldInfo })\n            return ids\n          })\n        } else {\n          return []\n        }\n      })\n    }, [placeFieldValidate, createInnerFieldInfo])\n    // 移动事件\n    const moveField = React.useCallback(({ type: dropType, ...placeLayerInfo }: any, { type: dragType, ...dragFieldInfo }: any, noValidate: boolean = false) => {\n      Promise.resolve(validateOperation(noValidate, placeLayerInfo, dragFieldInfo, moveFieldValidate)).then(({ validateResult, operationField, contentField }) => {\n        if (validateResult) {\n          formDesignDataDiepatch({ type: constants.MOVE_FIELD, placeLayerInfo, dragFieldInfo })\n        }\n      })\n    }, [moveFieldValidate])\n    // 删除事件\n    const deleteField = React.useCallback((fieldId: string | string[], contentFieldId: string | null, deleteIndex: number | null, e: any, noValidate: boolean = false) => {\n      e?.stopPropagation()\n      return Promise.resolve(validateOperation(noValidate, { id: contentFieldId }, { id: fieldId }, deleteFieldValidate)).then(({ validateResult, operationField, contentField }) => {\n        let dispatchParams: any\n        let isBatchDel = false\n        if (Array.isArray(validateResult)) {\n          if (validateResult?.length) {\n            dispatchParams = { fieldId: validateResult }\n            isBatchDel = true\n          }\n        } else if (validateResult) {\n          // TODO 内置方法处理需要联动多个字段同时删除的情况\n          if (Array.isArray(fieldId) && fieldId?.length) {\n            dispatchParams = { deleteIds: fieldId }\n            isBatchDel = true\n          } else {\n            dispatchParams = { fieldId, deleteIndex, contentFieldId }\n          }\n        }\n        return { isBatchDel, dispatchParams }\n      }).then(({ isBatchDel, dispatchParams }) => {\n        let deleteResult = false\n        if (dispatchParams) {\n          if (isBatchDel) {\n            formDesignDataDiepatch({ type: constants.BATCH_DELETE_FIELD, ...dispatchParams })\n          } else {\n            formDesignDataDiepatch({ type: constants.DELETE_FIELD, ...dispatchParams })\n          }\n          deleteResult = true\n        }\n        return deleteResult\n      })\n    }, [deleteFieldValidate])\n    // 选中事件\n    const selectField = React.useCallback((selectId: string, e?: any) => {\n      e?.stopPropagation()\n      formDesignDataDiepatch({ type: constants.SELECT_FIELD, selectId })\n    }, [])\n    // 复制事件\n    const copyField = React.useCallback((copyFieldId: string, contentFieldId: string | null, innerIndex: number, e: any, noValidate: boolean = false) => {\n      e?.stopPropagation()\n      const supInfo = FormDesignSupInfo[formDesignId]\n      return Promise.resolve(validateOperation(noValidate, { id: contentFieldId }, { id: copyFieldId }, copyFieldValidate)).then(({ validateResult, operationField, contentField }) => {\n        if (validateResult) {\n          return Promise.resolve(createCopyFieldInfo?.(operationField, contentField) || operationField).then((field) => {\n            const [fields, ids] = createNewFieldHandle(field, supInfo);\n            formDesignDataDiepatch({\n              type: constants.COPY_FIELD,\n              contentFieldId,\n              innerIndex,\n              copyField: fields\n            })\n            return ids\n          })\n        } else {\n          return []\n        }\n      })\n    }, [validateOperation, copyFieldValidate, createCopyFieldInfo])\n    const operationsContextValue = React.useMemo(() => ({ placeField, moveField, deleteField, selectField, copyField }), [])\n    return <FieldOperationsContext.Provider value={operationsContextValue}>\n      <InnerComponent {...otherProps} ref={ref} />\n    </FieldOperationsContext.Provider>\n  })\n}\n\ntype FCType<T> = React.FC<T>\ntype FCwithCtxType<T> = T extends FCType<infer U> ? U : any\nconst ContextsWrapper = <T,>(ctxWraps: Array<(InnerComponent: React.ElementType) => React.FC>) => <P extends FCwithCtxType<T>,>(InnerComponent: React.ComponentType<P>) => ctxWraps.reduceRight((acc:any, ctxWrap) => ctxWrap(acc), InnerComponent)\n//@ts-ignore\nconst FormDesignProviderWrapper = ContextsWrapper<IFormDesignProps>([RootContextWrapper, dataContextWrapper, operationsContextWrapper])\n\nexport {\n  FormDesignProviderWrapper\n}","import * as  React from 'react'\nimport cs from 'classnames'\nimport memoized from 'memoize-one';\nimport { useDrag, useDrop } from 'react-dnd'\nimport { DeleteOutlined, CopyOutlined } from '@ant-design/icons'\nimport { FieldOperationsContext, FormDesignRootContext } from './context-wrapper'\nimport * as constants from '../constants'\nimport { IDropProps } from '../module'\n\n// memo\nconst funcMemo = memoized((targetFunc: any, ...params: any) => (...otherParams: any) => targetFunc(...params, ...otherParams)\n)\n\nenum postions {\n    top = \"top\",\n    bottom = \"bottom\",\n    left = \"left\",\n    right = \"right\",\n    none = \"\"\n}\n\nconst useDnd = (isDropContent: boolean, { placeField, moveField, selectField, type, accept, canDrag = true, formDesignPerfixCls }: {\n    placeField: (dragField: any, dropField: any, noValidate?: boolean) => Promise<string[]>,\n    moveField: (dragField: any, dropField: any, noValidate?: boolean) => void,\n    selectField: (fieldId: string) => void,\n    type: string,\n    accept: string | string[]\n    canDrag?: boolean,\n    formDesignPerfixCls?: string\n}, { contentFieldId, fieldId, index, }: any): [React.MutableRefObject<any>, boolean, { show: boolean, sign: postions }] => {\n\n    const [locationMarker, setLocationMarker] = React.useState<{ show: boolean, sign: postions }>({ show: false, sign: postions.none })\n\n    const ref = React.useRef<any>(null)\n\n    const [dragCollectData, connectDrag, connectDragPreview] = useDrag({\n        item: { type, id: fieldId, contentFieldId, dragIndex: index },\n        canDrag,\n        collect: monitor => ({\n            isDragging: monitor.isDragging(),\n        })\n    })\n\n    const getArea = React.useCallback((eventPostions: { [key in \"x\" | \"y\"]: number }, contentInfo: DOMRect) => {\n        const { top, height, bottom } = contentInfo\n        const { y } = eventPostions\n        if (y - top < 0 || bottom - y < 0) {\n            return\n        }\n        const newLocationMarker = { show: true, sign: y - top <= height / 2 ? postions.top : postions.bottom }\n        if (locationMarker.show !== newLocationMarker.show || locationMarker.sign !== newLocationMarker.sign) {\n            setLocationMarker(newLocationMarker)\n        }\n    }, [locationMarker])\n\n    const [dropCollectData, connectDrop] = useDrop({\n        accept,\n        drop: (item, monitor) => {\n            const dropResult = monitor.getDropResult()\n            const isOverCurrent = monitor.isOver({ shallow: false })\n\n            const { id: draggedId } = monitor.getItem()\n            if (!dropResult && isOverCurrent) {\n                if (!draggedId) { //收集到的dragItem无id说明是新字段\n                    const targetIndex = typeof index !== \"number\" || [postions.top, postions.left].includes(locationMarker.sign) ? index : index + 1\n                    placeField({ type, id: fieldId, contentFieldId, dropIndex: targetIndex }, item).then((ids) => {\n                        if (ids.length) {\n                            selectField(ids[0])\n                        }\n                    })\n                } else { //有id 说明是以生成的字段实例\n                    const targetIndex = typeof index !== \"number\" || [postions.bottom, postions.right].includes(locationMarker.sign) ? index : index - 1\n                    moveField?.({ type, id: fieldId, contentFieldId, dropIndex: targetIndex }, item)\n                }\n            }\n        },\n        hover: (item: any, monitor: any) => {\n\n            if ((item?.id !== fieldId || isDropContent) && monitor.isOver({ shallow: true }) && ref.current) {\n                const clientOffset = monitor.getClientOffset()\n                const contentInfo = ref.current.getBoundingClientRect()\n                /* \n                1.item?.parId !== parId 非同级不展示标记线\n                2. item.id && [item.index, item.index + 1].includes(clientOffset.y - contentInfo.top <= contentInfo.height / 2 ? index : index + 1))\n                移动事件结果在同一位置不展示标记线\n                */\n                if (item.id && [item.index, item.index + 1].includes(clientOffset.y - contentInfo.top <= contentInfo.height / 2 ? index : index + 1)) {\n                    return\n                }\n                getArea(clientOffset, contentInfo)\n            }\n        },\n        //经过可放下区域时触发\n        //收集函数  \n        collect: (monitor: any) => ({\n            isOver: monitor.isOver(),\n            isOverCurrent: monitor.isOver({ shallow: true }),\n            clientOffset: monitor.getClientOffset()\n        })\n    })\n\n    React.useEffect(() => {\n        if (!isDropContent) {\n            connectDrag(ref)\n            connectDragPreview(document.getElementById(`${formDesignPerfixCls}-faker-perview`))\n        }\n        connectDrop(ref)\n    }, [ref, isDropContent])\n\n    React.useEffect(() => {\n        let timeCount: any\n        if (locationMarker.show && !dropCollectData.isOverCurrent) {\n            timeCount = setTimeout(() => {\n                clearTimeout(timeCount)\n                setLocationMarker({ show: false, sign: postions.none })\n            }, 32)\n        }\n        return () => {\n            if (timeCount) {\n                clearTimeout(timeCount)\n            }\n        }\n    }, [locationMarker, dropCollectData.isOverCurrent])\n\n    return [ref, dragCollectData.isDragging, locationMarker]\n}\n\nconst ContentDrop = React.forwardRef<any, any>(({ children, contentFieldId, formDesignPerfixCls }, ref) => {\n    return <div className={`${formDesignPerfixCls}-drop-content`} style={{ zIndex: contentFieldId ? 11 : 1 }} ref={ref}>\n        {children}\n    </div>\n})\n\nconst FieldDragWithDrop = React.forwardRef<any, any>(({ children, contentFieldId, fieldId, isSelected, deleteField, selectField, copyField, canDel, canCopy, isDragging, isFirstField, isLastField, locationMarker, formDesignPerfixCls }, ref) => {\n\n    const hoverClassName = `${formDesignPerfixCls}-form-item-hover`\n    const MouseOver = (e: any) => {\n        e.stopPropagation()\n            ; (ref as any).current?.children[0].classList.add(hoverClassName)\n    }\n    const MouseOut = (e: any) => {\n        e.stopPropagation()\n            ; (ref as any).current?.children[0].classList.remove(hoverClassName)\n    }\n    const wrapperDeleteField = React.useCallback((e: any) => deleteField(e), [deleteField])\n    const wrappercopyField = React.useCallback((e: any) => copyField(e), [copyField])\n\n    return <div\n        id={fieldId}\n        ref={ref}\n        className={`${formDesignPerfixCls}-field-dnd-wrapper`}\n    >\n        <div\n            className={cs({\n                [`${formDesignPerfixCls}-field-active`]: isSelected,\n                [`${formDesignPerfixCls}-first-field`]: isFirstField,\n                [`${formDesignPerfixCls}-last-field`]: isLastField,\n                [`${formDesignPerfixCls}-field-dragging`]: isDragging,\n                [`${formDesignPerfixCls}-location-${locationMarker.sign}-marker`]: locationMarker.show && locationMarker.sign,\n            })}\n            onClick={selectField}\n            onMouseOver={MouseOver}\n            onMouseOut={MouseOut}\n        >\n            <div className={`${formDesignPerfixCls}-field-border`}>\n                <div className={`${formDesignPerfixCls}-field-operation-area`} >\n                    <span>\n                        {canCopy && <CopyOutlined onClick={wrappercopyField as any} />}\n                    </span>\n                    <span>\n                        {canDel && <DeleteOutlined onClick={wrapperDeleteField as any} />}\n                    </span>\n                </div>\n                {children}\n            </div>\n        </div>\n    </div>\n})\n\nconst Drop: React.FC<React.PropsWithChildren<IDropProps>> = ({ isDropContent = false, accept = constants.BASE, type = constants.BASE, children, fieldId, index, contentFieldId, ...props }) => {\n\n    const { formDesignPerfixCls } = React.useContext(FormDesignRootContext)\n\n    const { placeField, moveField, selectField, deleteField, copyField } = React.useContext(FieldOperationsContext)\n\n    const newSelectField = funcMemo(selectField, fieldId)\n\n    const newDeleteField = funcMemo(deleteField, fieldId, contentFieldId, index)\n\n    const newCopyField = funcMemo(copyField, fieldId, contentFieldId, index)\n\n    const [ref, isDragging, locationMarker] = useDnd(isDropContent, { placeField, moveField, selectField, type, accept, canDrag: props.canDrag, formDesignPerfixCls }, {\n        contentFieldId,\n        fieldId,\n        index\n    })\n\n    const TargetComponent = React.useMemo(() => isDropContent ? ContentDrop : FieldDragWithDrop, [isDropContent])\n\n    return <TargetComponent\n        ref={ref}\n        {...props}\n        formDesignPerfixCls={formDesignPerfixCls}\n        fieldId={fieldId}\n        contentFieldId={contentFieldId}\n        selectField={newSelectField}\n        deleteField={newDeleteField}\n        copyField={newCopyField}\n        isDragging={isDragging}\n        locationMarker={locationMarker}\n    >\n        {children}\n    </TargetComponent>\n}\n\nexport default Drop\n","import { cloneDeep, findLastIndex } from \"lodash\";\nimport { getFieldPath, FormDesignSupInfo } from \"./common\";\nimport * as constants from \"../constants\";\nimport { IChangeTypeProps, IFormDesignDataReduceProps, IPostionInfoProps } from \"../module\";\n\nconst deleteObjectParams = (originData: { [key: string]: any }, key: string) => {\n  originData[key] = undefined;\n};\n\nexport const defaultState: IFormDesignDataReduceProps = {\n  formDesignId: \"\",\n  outerFieldPostions: [],\n  nestedFieldPostions: {},\n  fieldsMap: {},\n  selectedFieldId: null,\n};\n\n/* place */\n\n// 处理放置\nconst dealWithPlace = ({ innerField, placeLayerInfo, dragFieldInfo }: any, state: any, supInfo: any) => {\n  const { contentFieldId, dropIndex } = placeLayerInfo;\n  const operationData = contentFieldId\n    ? state.nestedFieldPostions[contentFieldId] ||\n      ((state.nestedFieldPostions[contentFieldId] = []), state.nestedFieldPostions[contentFieldId])\n    : state.outerFieldPostions;\n  const targetIndex = dropIndex || findLastIndex(operationData, (el: any) => el.visible) + 1;\n  const result = supInfo.transformFormVo?.(innerField);\n\n  operationData.splice(targetIndex, 0, ...result.outerFieldPostions);\n  contentFieldId\n    ? (state.nestedFieldPostions[contentFieldId] = [...operationData])\n    : (state.outerFieldPostions = [...operationData]);\n\n  Object.assign(state.fieldsMap, result.fieldsMap);\n\n  Object.assign(state.nestedFieldPostions, result.nestedFieldPostions);\n};\n\n/* copy */\nconst dealWithCopy = ({ contentFieldId, copyField, innerIndex }: any, state: any, supInfo: any) => {\n  // 执行创建新字段的统一操作\n  const result = supInfo.transformFormVo?.(copyField);\n\n  const operationData = contentFieldId ? state.nestedFieldPostions[contentFieldId] : state.outerFieldPostions;\n\n  operationData.splice(innerIndex + 1, 0, ...result.outerFieldPostions);\n  contentFieldId\n    ? (state.nestedFieldPostions[contentFieldId] = [...operationData])\n    : (state.outerFieldPostions = [...operationData]);\n\n  Object.assign(state.nestedFieldPostions, result.nestedFieldPostions);\n\n  Object.assign(state.fieldsMap, result.fieldsMap);\n};\n/* move */\nconst dealWithMoveOperationData = (\n  opreationData: any[],\n  innerField: { index?: number; id: string } = { id: \"\" },\n  removeField: { index?: number } = {}\n): any => {\n  const { index: innerIndex, id: innerFieldId } = innerField;\n  const { index: removeIndex } = removeField;\n  const initAcc: any[] = [];\n  const innerFieldInfo = opreationData.filter((el: any) => el.id === innerFieldId)[0];\n  // 操作数组是空数组 或者 判定落点在头部\n  if (!opreationData.length || innerIndex === -1) {\n    initAcc.push(innerFieldInfo);\n  }\n  const result = opreationData.reduce((acc: any[], next: any, i: number) => {\n    if (i !== removeIndex) {\n      acc.push(next);\n    }\n    if (i === innerIndex && innerFieldInfo) {\n      acc.push(innerFieldInfo);\n    }\n    return acc;\n  }, initAcc);\n  // 判定落点在可见数组的最后\n  if (innerFieldInfo && innerIndex === undefined) {\n    const targetIndex = findLastIndex(result, (el: any) => el.visible) + 1;\n    result.splice(targetIndex, 0, innerFieldInfo);\n  }\n  return result;\n};\nconst dealWithMove = (\n  { placeLayerInfo, dragFieldInfo }: any,\n  { nestedContainerFieldPostions, outerFieldPostions }: any\n) => {\n  const { id: dragId, contentFieldId: dragContentFieldId, dragIndex } = dragFieldInfo;\n  const { contentFieldId: dropContentFieldId, dropIndex } = placeLayerInfo;\n  let addOperationData = dropContentFieldId ? nestedContainerFieldPostions[dropContentFieldId] : outerFieldPostions;\n  let removeOperationData = dragContentFieldId ? nestedContainerFieldPostions[dragContentFieldId] : outerFieldPostions;\n  let changeParams: any[] = [];\n  if (addOperationData === removeOperationData) {\n    //操作同一个字段组\n    addOperationData = dealWithMoveOperationData(\n      addOperationData,\n      { index: dropIndex, id: dragId },\n      { index: dragIndex }\n    );\n    changeParams = [addOperationData];\n  } else {\n    //操作不同的字段组\n    //添加操作\n    addOperationData = dealWithMoveOperationData(addOperationData, {\n      index: dropIndex || addOperationData.length - 1,\n      id: dragId,\n    });\n    //移除操作\n    removeOperationData = dealWithMoveOperationData(removeOperationData, undefined, {\n      index: dragIndex,\n    });\n    changeParams = [addOperationData, removeOperationData];\n  }\n  switch (changeParams.length) {\n    case 1:\n      dropContentFieldId\n        ? (nestedContainerFieldPostions[dropContentFieldId] = changeParams[0])\n        : (outerFieldPostions = changeParams[0]);\n      return { nestedContainerFieldPostions, outerFieldPostions };\n    case 2:\n      dropContentFieldId\n        ? (nestedContainerFieldPostions[dropContentFieldId] = changeParams[0])\n        : (outerFieldPostions = changeParams[0]);\n      dragContentFieldId\n        ? (nestedContainerFieldPostions[dragContentFieldId] = changeParams[1])\n        : (outerFieldPostions = changeParams[1]);\n      return { nestedContainerFieldPostions, outerFieldPostions };\n    default:\n      return null;\n  }\n};\n/* delete */\nconst dealWithDelete = ({ fieldId, contentFieldId }: any, state: any) => {\n  const operationData = (contentFieldId ? state.nestedFieldPostions[contentFieldId] : state.outerFieldPostions).filter(\n    (el: IPostionInfoProps) => el.id !== fieldId\n  );\n  contentFieldId\n    ? (state.nestedFieldPostions[contentFieldId] = [...operationData])\n    : (state.outerFieldPostions = [...operationData]);\n  if (state.nestedFieldPostions[fieldId]) {\n    deleteObjectParams(state.nestedFieldPostions, fieldId);\n  }\n  const parIds = getFieldPath(state.selectedFieldId, state.fieldsMap);\n  const deleteFieldPostions = parIds.indexOf(fieldId);\n\n  if (deleteFieldPostions >= 0) {\n    state.selectedFieldId = parIds[deleteFieldPostions + 1] || null;\n  }\n\n  deleteObjectParams(state.fieldsMap, fieldId);\n};\n/* batch delete*/\nconst dealWithBatchDelete = ({ fieldId }: any, state: any) => {\n  const { nestedFieldPostions, fieldsMap } = state;\n  let outerFieldPostions = state.outerFieldPostions;\n  let selectedFieldId = state.selectedFieldId;\n  const selectFieldParIds = getFieldPath(state.selectedFieldId, state.fieldsMap);\n  let finalPosition = -1;\n  if (Array.isArray(fieldId)) {\n    fieldId.forEach((id) => {\n      const element = fieldsMap[id];\n      if (element) {\n        if (element.parId) {\n          nestedFieldPostions[element.parId] = nestedFieldPostions[element.parId].filter((el: any) => el.id !== id);\n          if (nestedFieldPostions[id]) {\n            deleteObjectParams(nestedFieldPostions, id);\n          }\n        } else {\n          outerFieldPostions = outerFieldPostions.filter((el: any) => el.id !== id);\n        }\n        deleteObjectParams(fieldsMap, id);\n        const deleteFieldPostion = selectFieldParIds.indexOf(id);\n        finalPosition = Math.max(deleteFieldPostion, finalPosition);\n      }\n    });\n    if (finalPosition >= 0) {\n      selectedFieldId = selectFieldParIds[finalPosition + 1] || null;\n    }\n  }\n  return { nestedFieldPostions, outerFieldPostions, fieldsMap, selectedFieldId };\n};\n/* change */\nconst dealWithChange = ({ fieldId, newFieldInfo = {}, cover }: any, state: any, supInfo: any) => {\n  fieldId = fieldId || state.selectedFieldId;\n  const changeField = state.fieldsMap[fieldId];\n  state.fieldsMap[fieldId] = cover\n    ? { ...newFieldInfo, parId: changeField.parId }\n    : Object.assign({ parId: changeField.parId }, changeField, cloneDeep(newFieldInfo));\n};\n/* clear */\nconst clearFieldsMap = (fieldsMap: any) => {\n  for (const key in fieldsMap) {\n    if (Object.prototype.hasOwnProperty.call(fieldsMap, key)) {\n      fieldsMap[key] = undefined;\n    }\n  }\n};\nconst FormDesignReducer = (\n  state: any = cloneDeep(defaultState),\n  { type, formDesignId, ...otherProps }: any\n): IFormDesignDataReduceProps => {\n  const supInfo = FormDesignSupInfo[state.formDesignId] || {};\n  switch (type) {\n    /* 初始化阶段 */\n    case constants.INIT_FORMDESIGN:\n      return { ...state, formDesignId };\n    /* 修改formVo */\n    case constants.CHANGE_FORMVO:\n      const { fieldsMap: newFieldsMap, ...newState } = supInfo.transformFormVo?.(otherProps.formVo || []) || {};\n      clearFieldsMap(state.fieldsMap);\n      Object.assign(state.fieldsMap, newFieldsMap || {});\n      return { ...state, ...newState };\n    /* 添加新字段 */\n    case constants.PLACE_FIELD:\n      dealWithPlace(otherProps, state, supInfo);\n      supInfo.onFormVoChange?.(IChangeTypeProps.add, otherProps.innerField);\n      return { ...state };\n    /* 复制一个新字段 */\n    case constants.COPY_FIELD:\n      dealWithCopy(otherProps, state, supInfo);\n      supInfo.onFormVoChange?.(IChangeTypeProps.copy, otherProps.copyField);\n      return { ...state };\n    /* 移动字段 重新排序 */\n    case constants.MOVE_FIELD:\n      const moveResult = dealWithMove(otherProps, state);\n      if (moveResult) {\n        const { placeLayerInfo, dragFieldInfo } = otherProps;\n        const moveField = state.fieldsMap[dragFieldInfo.id];\n        moveField.parId = placeLayerInfo.contentFieldId;\n        supInfo.onFormVoChange?.(IChangeTypeProps.move, moveField);\n        return { ...state, ...moveResult };\n      } else {\n        return state;\n      }\n    /* 删除一个字段 */\n    case constants.DELETE_FIELD:\n      dealWithDelete(otherProps, state);\n      supInfo.onFormVoChange?.(IChangeTypeProps.delete, otherProps.fieldId);\n      return { ...state };\n    /* 删除多个字段 */\n    case constants.BATCH_DELETE_FIELD:\n      const batchDelState = dealWithBatchDelete(otherProps, state);\n      supInfo.onFormVoChange?.(IChangeTypeProps.delete, otherProps.deleteIds);\n      return { ...state, ...batchDelState };\n    /* 选中一个字段 */\n    case constants.SELECT_FIELD:\n      supInfo.onFormVoChange?.(IChangeTypeProps.select, otherProps.selectId);\n      return { ...state, selectedFieldId: otherProps.selectId };\n    /* 修改选中字段的属性 */\n    case constants.CHANGE_FIELD:\n      dealWithChange(otherProps, state, supInfo);\n      return { ...state };\n    /* 数据恢复初始化阶段 */\n    case constants.CLEAR_FORMDESIGN:\n      return cloneDeep(defaultState);\n    default:\n      return state;\n  }\n};\n \nexport default FormDesignReducer;\n","import React from 'react'\nimport { useDrag } from 'react-dnd'\nimport cs from 'classnames'\n// import IrsBaseIcon from '@ant-design/icons'\nimport { IDragProps } from '../module'\nimport * as constants from '../constants'\nimport { FormDesignRootContext } from './context-wrapper'\nimport { FormDesignSupInfo } from './common'\n\nconst DragDiv: React.FC<IDragProps> = React.memo(({ type = constants.BASE, canDrag = true, formDesignPerfixCls, uniquelySign }) => {\n    const [, baseDrag, connectDragPreview] = useDrag({\n        item: { type, uniquelySign },\n        options: {\n            dropEffect: \"copy\"\n        },\n        canDrag: () => canDrag\n    })\n\n    React.useEffect(() => {\n        connectDragPreview(document.getElementById(`${formDesignPerfixCls}-faker-perview`))\n    }, [formDesignPerfixCls])\n\n    return <><div\n        ref={baseDrag}\n        className={cs(`${formDesignPerfixCls}-drag-layer`, { [`${formDesignPerfixCls}-drag-disable`]: !canDrag })}\n    />\n    </>\n})\n\nconst DragLayout: React.FC<React.PropsWithChildren<IDragProps & { formDesignId: string }>> = React.memo((props) => {\n    const { children, type = constants.BASE, uniquelySign, canDrag, title, style, className, formDesignPerfixCls, formDesignId, ...otherProps } = props\n    const supInfo = FormDesignSupInfo[formDesignId!]\n    const dragId = React.useMemo(() => `${type}_${uniquelySign}`, [type, uniquelySign])\n    React.useEffect(() => {\n        if (supInfo) {\n            supInfo.dndMaskLayerTemplates[uniquelySign] = { id: dragId, uniquelySign, type, name: title, ...otherProps }\n        }\n    }, [supInfo, dragId])\n    return <div className={cs(`${formDesignPerfixCls}-drag-range`, className)} id={dragId} title={title} style={style}>\n        <DragDiv type={type} uniquelySign={uniquelySign} canDrag={canDrag} formDesignPerfixCls={formDesignPerfixCls} />\n        {children}\n    </div>\n})\n\nconst Drag: React.FC<IDragProps & { info: { name: string, iconClass: string } }> = ({ info, ...dragProps }) => {\n    const { formDesignId, formDesignPerfixCls } = React.useContext(FormDesignRootContext)\n\n    return <DragLayout {...info} {...dragProps} title={info.name} formDesignId={formDesignId!} formDesignPerfixCls={formDesignPerfixCls}>\n        <div className={`${formDesignPerfixCls}-single-widget-content`}>\n            {/* <IrsBaseIcon className={`${formDesignPerfixCls}-single-widget-icon`} type={info.iconClass} /> */}\n            <div className={`${formDesignPerfixCls}-single-widget-text`}>\n                {info.name}\n            </div>\n        </div>\n    </DragLayout>\n}\n\nexport const DragLayoutWithContext: React.FC<IDragProps> = (props) => {\n    const { formDesignId, formDesignPerfixCls } = React.useContext(FormDesignRootContext)\n\n    return <DragLayout {...props} formDesignId={formDesignId!} formDesignPerfixCls={formDesignPerfixCls} />\n}\n\nexport default Drag\n","/* eslint-disable */\nvar __assign = (this && this.__assign) || function () {\n  __assign = Object.assign || function(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n      }\n      return t;\n  };\n  return __assign.apply(this, arguments);\n};\n\nimport { createContext, useContext } from 'react';\nexport var FormLayoutDeepContext = createContext(null);\nexport var FormLayoutShallowContext = createContext(null);\nexport var useFormDeepLayout = function () { return useContext(FormLayoutDeepContext); };\nexport var useFormShallowLayout = function () { return useContext(FormLayoutShallowContext); };\nexport var useFormLayout = function () { return (__assign(__assign({}, useFormDeepLayout()), useFormShallowLayout())); };","/* eslint-disable */\nvar __assign = (this && this.__assign) || function () {\n  __assign = Object.assign || function(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n      }\n      return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n};\nvar __read = (this && this.__read) || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n};\nimport React, { useLayoutEffect, useRef, useState } from 'react';\nimport cls from 'classnames';\nimport { usePrefixCls, pickDataProps } from './__builtins__';\nimport { isVoidField } from '@formily/core';\nimport { connect, mapProps } from '@formily/react';\nimport { useFormLayout, FormLayoutShallowContext } from './form-layout';\n// import { useGridSpan } from '../form-grid';\nimport  Tooltip from 'antd/lib/tooltip';\nimport Popover from 'antd/lib/popover'\nimport { QuestionCircleOutlined, CloseCircleOutlined, CheckCircleOutlined, ExclamationCircleOutlined, } from '@ant-design/icons';\nvar useFormItemLayout = function (props) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z;\n    var layout = useFormLayout();\n    return __assign(__assign({}, props), { layout: (_b = (_a = props.layout) !== null && _a !== void 0 ? _a : layout.layout) !== null && _b !== void 0 ? _b : 'horizontal', colon: (_c = props.colon) !== null && _c !== void 0 ? _c : layout.colon, labelAlign: layout.layout === 'vertical'\n            ? (_e = (_d = props.labelAlign) !== null && _d !== void 0 ? _d : layout.labelAlign) !== null && _e !== void 0 ? _e : 'left' : (_g = (_f = props.labelAlign) !== null && _f !== void 0 ? _f : layout.labelAlign) !== null && _g !== void 0 ? _g : 'right', labelWrap: (_h = props.labelWrap) !== null && _h !== void 0 ? _h : layout.labelWrap, labelWidth: (_j = props.labelWidth) !== null && _j !== void 0 ? _j : layout.labelWidth, wrapperWidth: (_k = props.wrapperWidth) !== null && _k !== void 0 ? _k : layout.wrapperWidth, labelCol: (_l = props.labelCol) !== null && _l !== void 0 ? _l : layout.labelCol, wrapperCol: (_m = props.wrapperCol) !== null && _m !== void 0 ? _m : layout.wrapperCol, wrapperAlign: (_o = props.wrapperAlign) !== null && _o !== void 0 ? _o : layout.wrapperAlign, wrapperWrap: (_p = props.wrapperWrap) !== null && _p !== void 0 ? _p : layout.wrapperWrap, fullness: (_q = props.fullness) !== null && _q !== void 0 ? _q : layout.fullness, size: (_r = props.size) !== null && _r !== void 0 ? _r : layout.size, inset: (_s = props.inset) !== null && _s !== void 0 ? _s : layout.inset, asterisk: props.asterisk, bordered: (_t = props.bordered) !== null && _t !== void 0 ? _t : layout.bordered, feedbackIcon: props.feedbackIcon, feedbackLayout: (_v = (_u = props.feedbackLayout) !== null && _u !== void 0 ? _u : layout.feedbackLayout) !== null && _v !== void 0 ? _v : 'loose', tooltipLayout: (_x = (_w = props.tooltipLayout) !== null && _w !== void 0 ? _w : layout.tooltipLayout) !== null && _x !== void 0 ? _x : 'icon', tooltipIcon: (_z = (_y = props.tooltipIcon) !== null && _y !== void 0 ? _y : layout.tooltipIcon) !== null && _z !== void 0 ? _z : (React.createElement(QuestionCircleOutlined, null)) });\n};\nfunction useOverflow() {\n    var _a = __read(useState(false), 2), overflow = _a[0], setOverflow = _a[1];\n    var containerRef = useRef();\n    var contentRef = useRef();\n    useLayoutEffect(function () {\n        /* 2022-01-02 去掉对label宽度的计算展示方式控制 */\n        if (containerRef.current && contentRef.current) {\n            var contentWidth = contentRef.current.getBoundingClientRect().width;\n            var containerWidth = containerRef.current.getBoundingClientRect().width;\n            if (contentWidth && containerWidth && containerWidth < contentWidth) {\n                // if (!overflow) \n                    // setOverflow(true);\n            }\n            else {\n                if (overflow)\n                    setOverflow(false);\n            }\n        }\n    }, []);\n    return {\n        overflow: overflow,\n        containerRef: containerRef,\n        contentRef: contentRef,\n    };\n}\nvar ICON_MAP = {\n    error: React.createElement(CloseCircleOutlined, null),\n    success: React.createElement(CheckCircleOutlined, null),\n    warning: React.createElement(ExclamationCircleOutlined, null),\n};\nexport var BaseItem = function ({id,...props}) {\n    var _a, _b, _c, _d, _e;\n    var children = props.children, others = __rest(props, [\"children\"]);\n    var _f = __read(useState(false), 2), active = _f[0], setActice = _f[1];\n    var formLayout = useFormItemLayout(others);\n    // var gridSpan = useGridSpan(props.gridSpan);\n    var _g = useOverflow(), containerRef = _g.containerRef, contentRef = _g.contentRef, overflow = _g.overflow;\n    var label = formLayout.label, style = formLayout.style, layout = formLayout.layout, _h = formLayout.colon, colon = _h === void 0 ? true : _h, addonBefore = formLayout.addonBefore, addonAfter = formLayout.addonAfter, asterisk = formLayout.asterisk, feedbackStatus = formLayout.feedbackStatus, extra = formLayout.extra, feedbackText = formLayout.feedbackText, fullness = formLayout.fullness, feedbackLayout = formLayout.feedbackLayout, feedbackIcon = formLayout.feedbackIcon, inset = formLayout.inset, _j = formLayout.bordered, bordered = _j === void 0 ? true : _j, labelWidth = formLayout.labelWidth, wrapperWidth = formLayout.wrapperWidth, labelCol = formLayout.labelCol, wrapperCol = formLayout.wrapperCol, labelAlign = formLayout.labelAlign, _k = formLayout.wrapperAlign, wrapperAlign = _k === void 0 ? 'left' : _k, size = formLayout.size, labelWrap = formLayout.labelWrap, wrapperWrap = formLayout.wrapperWrap, tooltipLayout = formLayout.tooltipLayout, tooltip = formLayout.tooltip, tooltipIcon = formLayout.tooltipIcon;\n    // 2021-12-30 设置空格符占位标题在布局上的调整\n    label = labelCol ===24 && /^\\s+$/.test(label) ?null:label\n    \n    var labelStyle = __assign({}, formLayout.labelStyle);\n    var wrapperStyle = __assign({}, formLayout.wrapperStyle);\n    // 固定宽度\n    var enableCol = false;\n    if (labelWidth || wrapperWidth) {\n        if (labelWidth) {\n            labelStyle.width = labelWidth === 'auto' ? undefined : labelWidth;\n            labelStyle.maxWidth = labelWidth === 'auto' ? undefined : labelWidth;\n        }\n        if (wrapperWidth) {\n            wrapperStyle.width = wrapperWidth === 'auto' ? undefined : wrapperWidth;\n            wrapperStyle.maxWidth = wrapperWidth === 'auto' ? undefined : wrapperWidth;\n        }\n        // 栅格模式\n    }\n    if (labelCol || wrapperCol) {\n        if (!labelStyle.width && !wrapperStyle.width) {\n            enableCol = true;\n        }\n    }\n    var prefixCls = usePrefixCls('formily-item', props);\n    var formatChildren = feedbackLayout === 'popover' ? (React.createElement(Popover, { autoAdjustOverflow: true, placement: \"top\", content: React.createElement(\"div\", { className: cls((_a = {},\n                _a[prefixCls + \"-\" + feedbackStatus + \"-help\"] = !!feedbackStatus,\n                _a[prefixCls + \"-help\"] = true,\n                _a)) },\n            ICON_MAP[feedbackStatus],\n            \" \",\n            feedbackText), visible: !!feedbackText }, children)) : (children);\n    var gridStyles = {};\n    // if (gridSpan) {\n    //     gridStyles.gridColumnStart = \"span \" + gridSpan;\n    // }\n    var getOverflowTooltip = function () {\n        if (overflow) {\n            return (React.createElement(\"div\", null,\n                React.createElement(\"div\", null, label),\n                React.createElement(\"div\", null, tooltip)));\n        }\n        return tooltip;\n    };\n    var renderLabelText = function () {\n        var labelChildren = (React.createElement(\"div\", { className: cls(prefixCls + \"-label-content\"), ref: containerRef },\n            asterisk && (React.createElement(\"span\", { className: cls(prefixCls + \"-asterisk\") }, '*')),\n            React.createElement(\"label\", { ref: contentRef }, label)));\n        if ((tooltipLayout === 'text' && tooltip) || overflow) {\n            return (React.createElement(Tooltip, { placement: \"top\", align: { offset: [0, 10] }, title: getOverflowTooltip() }, labelChildren));\n        }\n        return labelChildren;\n    };\n    var renderTooltipIcon = function () {\n        if (tooltip && tooltipLayout === 'icon' && !overflow) {\n            return (React.createElement(\"span\", { className: cls(prefixCls + \"-label-tooltip-icon\") },\n                React.createElement(Tooltip, { placement: \"top\", align: { offset: [0, 2] }, title: tooltip }, tooltipIcon)));\n        }\n    };\n    var renderLabel = function () {\n        var _a;\n        if (!label)\n            return null;\n        return (React.createElement(\"div\", { className: cls((_a = {},\n                _a[prefixCls + \"-label\"] = true,\n                _a[prefixCls + \"-label-tooltip\"] = (tooltip && tooltipLayout === 'text') || overflow,\n                _a[prefixCls + \"-item-col-\" + labelCol] = enableCol && !!labelCol,\n                _a)), style: labelStyle },\n            renderLabelText(),\n            renderTooltipIcon(),\n            label !== ' ' && (React.createElement(\"span\", { className: cls(prefixCls + \"-colon\") }, colon ? ':' : ''))));\n    };\n\n    return (React.createElement(\"div\", __assign({}, pickDataProps(props), { style: __assign(__assign({}, style), gridStyles), className: cls((_b = {},\n            _b[\"\" + prefixCls] = true,\n            _b[prefixCls + \"-layout-\" + layout] = true,\n            _b[prefixCls + \"-\" + feedbackStatus] = !!feedbackStatus,\n            _b[prefixCls + \"-feedback-has-text\"] = !!feedbackText,\n            _b[prefixCls + \"-size-\" + size] = !!size,\n            _b[prefixCls + \"-feedback-layout-\" + feedbackLayout] = !!feedbackLayout,\n            _b[prefixCls + \"-fullness\"] = !!fullness || !!inset || !!feedbackIcon,\n            _b[prefixCls + \"-inset\"] = !!inset,\n            _b[prefixCls + \"-active\"] = active,\n            _b[prefixCls + \"-inset-active\"] = !!inset && active,\n            _b[prefixCls + \"-label-align-\" + labelAlign] = true,\n            _b[prefixCls + \"-control-align-\" + wrapperAlign] = true,\n            _b[prefixCls + \"-label-wrap\"] = !!labelWrap,\n            _b[prefixCls + \"-control-wrap\"] = !!wrapperWrap,\n            _b[prefixCls + \"-bordered-none\"] = bordered === false || !!inset || !!feedbackIcon,\n            _b[props.className] = !!props.className,\n            _b)), onFocus: function () {\n            if (feedbackIcon || inset) {\n                setActice(true);\n            }\n        }, onBlur: function () {\n            if (feedbackIcon || inset) {\n                setActice(false);\n            }\n        }, /* 向下传递id */\n        id:id\n    }),\n        renderLabel(),\n        React.createElement(\"div\", { className: cls((_c = {},\n                _c[prefixCls + \"-control\"] = true,\n                _c[prefixCls + \"-item-col-\" + wrapperCol] = enableCol && !!wrapperCol && label,\n                _c)) },\n            React.createElement(\"div\", { className: cls(prefixCls + \"-control-content\") },\n                addonBefore && (React.createElement(\"div\", { className: cls(prefixCls + \"-addon-before\") }, addonBefore)),\n                React.createElement(\"div\", { style: wrapperStyle, className: cls((_d = {},\n                        _d[prefixCls + \"-control-content-component\"] = true,\n                        _d[prefixCls + \"-control-content-component-has-feedback-icon\"] = !!feedbackIcon,\n                        _d)) },\n                    React.createElement(FormLayoutShallowContext.Provider, { value: undefined }, formatChildren),\n                    feedbackIcon && (React.createElement(\"div\", { className: cls(prefixCls + \"-feedback-icon\") }, feedbackIcon))),\n                addonAfter && (React.createElement(\"div\", { className: cls(prefixCls + \"-addon-after\") }, addonAfter))),\n            !!feedbackText &&\n                feedbackLayout !== 'popover' &&\n                feedbackLayout !== 'none' && (React.createElement(\"div\", { className: cls((_e = {},\n                    _e[prefixCls + \"-\" + feedbackStatus + \"-help\"] = !!feedbackStatus,\n                    _e[prefixCls + \"-help\"] = true,\n                    _e[prefixCls + \"-help-enter\"] = true,\n                    _e[prefixCls + \"-help-enter-active\"] = true,\n                    _e)) }, feedbackText)),\n            extra && React.createElement(\"div\", { className: cls(prefixCls + \"-extra\") }, extra))));\n};\n// 适配\nexport var FormItem = connect(BaseItem, mapProps({ validateStatus: true, title: 'label', required: true }, function (props, field) {\n    if (isVoidField(field))\n        return {\n            extra: props.extra || field.description,\n        };\n    if (!field)\n        return props;\n    var takeMessage = function () {\n        var split = function (messages) {\n            return messages.reduce(function (buf, text, index) {\n                if (!text)\n                    return buf;\n                return index < messages.length - 1\n                    ? buf.concat([text, ', '])\n                    : buf.concat([text]);\n            }, []);\n        };\n        if (field.validating)\n            return;\n        if (props.feedbackText)\n            return props.feedbackText;\n        if (field.selfErrors.length)\n            return split(field.selfErrors);\n        if (field.selfWarnings.length)\n            return split(field.selfWarnings);\n        if (field.selfSuccesses.length)\n            return split(field.selfSuccesses);\n    };\n    return {\n        feedbackText: takeMessage(),\n        extra: props.extra || field.description,\n    };\n}, function (props, field) {\n    var _a;\n    if (isVoidField(field))\n        return props;\n    if (!field)\n        return props;\n    return {\n        feedbackStatus: field.validateStatus === 'validating'\n            ? 'pending'\n            : ((_a = field.decorator[1]) === null || _a === void 0 ? void 0 : _a.feedbackStatus) || field.validateStatus,\n    };\n}, function (props, field) {\n    if (isVoidField(field))\n        return props;\n    if (!field)\n        return props;\n    var asterisk = false;\n    if (field.required && field.pattern !== 'readPretty') {\n        asterisk = true;\n    }\n    if ('asterisk' in props) {\n        asterisk = props.asterisk;\n    }\n    return {\n        asterisk: asterisk,\n    };\n},function(props,field){ // 改动1 传入id字段\n    const target = {}\n    if(field){\n        target.id = field.address.entire\n    }\n    return target\n}));\nFormItem.BaseItem = BaseItem;\nexport default FormItem;","/* eslint:disable */\nexport var usePrefixCls = function (tag, props) {\n  const antPrefixCls = props === null || props === void 0 ? \"ant\" : props.antPrefixCls;\n  const customizePrefixCls = props === null || props === void 0 ? void 0 : props.prefixCls;\n  if (customizePrefixCls) return customizePrefixCls;\n  return tag ? (antPrefixCls + \"-\").concat(tag) : antPrefixCls;\n};\n\nexport var pickDataProps = function (props) {\n  if (props === void 0) {\n    props = {};\n  }\n  return Object.keys(props).reduce(function (buf, key) {\n    if (key.includes(\"data-\")) {\n      buf[key] = props[key];\n    }\n    return buf;\n  }, {});\n};\n","import * as React from 'react'\n// import cs from 'classnames'\n// import { Ihr3ConfigConsumer } from 'ihr360-web-ui3/packages/config-provider'\nimport Col  from 'antd/lib/grid/col'\nimport BaseFormItem from './form-item.js'\nimport './style.js'\nclass FormItem extends React.Component<any, any> {\n  constructor(props: any) {\n    super(props)\n  }\n  render() {\n    const { span, labelCol, wrapperCol, className, ...otherProps } = this.props\n    return <Col span={span || 24}>\n      {/* <Ihr3ConfigConsumer> */}\n        {/* {(context: any) => { */}\n          <BaseFormItem\n            antPrefixCls={\"ant\"}\n            labelCol={labelCol}\n            wrapperCol={wrapperCol}\n            colon={labelCol !== 24}\n            labelAlign={labelCol !== 24 ? \"right\" : \"left\"}\n            // className={cs(`${context.antPrefixCls || \"ant4\"}-row ${context.ihrPrefixCls || \"ihr3\"}-row`, className)}\n            className={className}\n            {...otherProps} />\n        {/* }} */}\n      {/* </Ihr3ConfigConsumer> */}\n    </Col>\n  }\n}\n\nexport default FormItem","import * as React from 'react'\nimport cs from 'classnames'\nimport { reaction } from '@formily/reactive'\nimport Input from 'antd/lib/input'\nimport DatePicker from 'antd/lib/date-picker'\nimport FormItem from '../setter-pane/register-field/form-item'\nimport InputNumber from 'antd/lib/input-number'\nimport Select from 'antd/lib/select'\n// import IrsBaseIcon from 'ihr360-web-ui3/packages/base/irs-base-icon'\nimport { SimulatorWrapContext, SimulatorWrapLayoutContext } from './index'\nimport { FormDesignDataContext, FormDesignRootContext } from '../basic/context-wrapper'\nimport { FormDesignSupInfo } from '../basic/common'\n\nconst { TextArea } = Input\n\ninterface IFieldMarkProps {\n  formDesignPerfixCls: string\n  mode: string\n  supInfo: any\n  type: string\n}\n\nconst FieldMark = React.memo<IFieldMarkProps>(({ formDesignPerfixCls, supInfo, mode, type }) => {\n  const { dndMaskLayerTemplates } = supInfo\n  const [markLayerInfo, setMarkLayerInfo] = React.useState<any>(dndMaskLayerTemplates[type])\n  React.useEffect(() => {\n    reaction(() => {\n      if (!markLayerInfo) {\n        setMarkLayerInfo(dndMaskLayerTemplates[type])\n      }\n    })\n  }, [])\n  return <div className={`${formDesignPerfixCls}-field-mark`}>\n    {/* {markLayerInfo ? <><IrsBaseIcon type={markLayerInfo.iconClass} />{markLayerInfo.name}</> : null} */}\n  </div>\n})\n\nconst transformProps = (InnerComponents: React.ElementType) => {\n  return React.memo(({ fieldInfo }: any) => {\n    const { labelCol, wrapperCol } = React.useContext(SimulatorWrapLayoutContext)\n    const { mode, SuffixFieldDisplay, SuffixFieldWidth } = React.useContext(SimulatorWrapContext)\n    const { formDesignPerfixCls, formDesignId } = React.useContext(FormDesignRootContext)\n    const supInfo = FormDesignSupInfo[formDesignId!]\n    return <>\n      <FieldMark\n        formDesignPerfixCls={formDesignPerfixCls!}\n        supInfo={supInfo}\n        mode={mode}\n        type={fieldInfo.type}\n      />\n      <div style={{ flex: `0 0 ${SuffixFieldWidth}px` }} className={`${formDesignPerfixCls}-field-custom-area`}>\n        <SuffixFieldDisplay\n          fieldInfo={supInfo.recoverField(fieldInfo)}\n          mode={mode}\n        />\n      </div>\n      <FormItem\n        labelCol={labelCol}\n        wrapperCol={wrapperCol}\n        label={fieldInfo.title || \" \"}\n        asterisk={fieldInfo[\"statusInfo>statusType\"] === \"EDITABLE\" && fieldInfo.required}\n        tooltip={fieldInfo.description}\n        wrapperStyle={{ pointerEvents: \"none\" }}\n        style={{ marginBottom: \"0\" }}\n        mode={mode}\n      >\n        <InnerComponents\n          fieldInfo={fieldInfo}\n          placeholder={fieldInfo.tips}\n          disabled={fieldInfo[\"statusInfo>statusType\"] !== \"EDITABLE\"}\n          style={fieldInfo.style || {}}\n          className={cs(`${formDesignPerfixCls}-${fieldInfo.type?.replace(\"_\", \"-\")?.toLocaleLowerCase?.() || 'unknow'}-field`, fieldInfo.className)}\n          mode={mode}\n        />\n      </FormItem>\n    </>\n  })\n}\n\nconst TEXT: React.FC<any> = transformProps(({ fieldInfo, ...props }) => <Input {...props} />)\n\nconst TEXTAREA: React.FC<any> = transformProps(({ fieldInfo, ...props }) => <TextArea width=\"100%\"  {...props} />)\n\nconst DATE: React.FC<any> = transformProps((props) => {\n  return <DatePicker width=\"100%\" block={true} {...props} />\n})\n\nconst NUMBER: React.FC<any> = transformProps(({ fieldInfo, ...props }) => {\n  const className = cs('input-number-handler-wrap-contorl', props.className)\n  return <InputNumber  {...props} className={className} />\n})\n\n\nconst RADIO: React.FC<any> = transformProps(({ fieldInfo, ...props }) => <Select {...props} />)\n\nconst UIComponents: any = { TEXT, TEXTAREA, DATE, NUMBER,  RADIO }\n\nconst FieldUIComponent: React.FC<{ fieldId: string }> = ({ fieldId }) => {\n  const { fieldsMap } = React.useContext(FormDesignDataContext)\n  const fieldInfo = fieldsMap[fieldId]\n  const FieldDisplay = React.useMemo(() => UIComponents[fieldInfo.type], [fieldInfo.type])\n  return <FieldDisplay\n    fieldInfo={fieldInfo}\n  />\n}\nconst isObject = (data: any) => Object.prototype.toString.call(data) === \"[object Object]\";\n// 扩充字段模拟展示状态\nexport const expandHandle = (expandFieldsDisplay: { [key: string]: React.ComponentType }) => {\n  if (isObject(expandFieldsDisplay)) {\n    Object.entries(expandFieldsDisplay).forEach(([key, UIComponent]) => {\n      UIComponents[key] = transformProps(UIComponent)\n    })\n  }\n}\n\nexport default FieldUIComponent\n\n","import * as React from 'react'\nimport Row  from 'antd/lib/grid/row'\nimport Drop from '../basic/drop'\nimport { FormDesignDataContext, FormDesignRootContext } from '../basic/context-wrapper'\nimport FieldUIComponent, { expandHandle } from './field-display'\nimport './style.less'\nimport { ISimulatorWrapProps } from '../module'\n\nconst DefaultNoData = () => {\n  return <div style={{display:\"flex\",height:'100%',justifyContent:\"center\",alignItems:\"center\"}}>请从左边拖入一个组件</div>\n}\n\nconst FieldGroupContent: React.FC<any> = React.memo(({ fieldGroupData, contentFieldId, selectedFieldId }) => {\n  const groupLength = fieldGroupData.length - 1\n  return <Row>\n    {fieldGroupData.map(({ id: fieldId, ...functionContorl }: any, i: number) => {\n      if (typeof functionContorl.visible === \"boolean\" && !functionContorl.visible) {\n        return null\n      }\n      return <Drop\n        key={fieldId}\n        isFirstField={!i}\n        isLastField={i === groupLength}\n        index={i}\n        contentFieldId={contentFieldId}\n        fieldId={fieldId}\n        isSelected={selectedFieldId === fieldId}\n        {...functionContorl}\n      >\n        <FieldUIComponent fieldId={fieldId} />\n      </Drop>\n    })}\n  </Row>\n})\n\n/** \n * 字段组渲染\n * @param mode 移动端和web端展示的样式标记\n * @param groupId 当前字段组的id 最外层为null 嵌套层为自身id \n */\nconst DropFieldGroup: React.FC<any> = React.memo(({ contentFieldId, fieldGroupData, selectedFieldId, customNoData = null }) => {\n  return <Drop\n    isDropContent={true}\n    contentFieldId={contentFieldId}\n  >\n    {fieldGroupData?.length ?\n      <FieldGroupContent\n        contentFieldId={contentFieldId}\n        fieldGroupData={fieldGroupData}\n        selectedFieldId={selectedFieldId}\n      /> : customNoData}\n  </Drop>\n})\n\nexport const DropFieldGroupWithContext: React.FC<any> = ({ contentFieldId, customNoData }) => {\n  const { outerFieldPostions, nestedFieldPostions, selectedFieldId } = React.useContext(FormDesignDataContext)\n  const fieldGroupData = contentFieldId ? nestedFieldPostions[contentFieldId] : outerFieldPostions\n  return <DropFieldGroup\n    contentFieldId={contentFieldId}\n    selectedFieldId={selectedFieldId}\n    fieldGroupData={fieldGroupData}\n    customNoData={customNoData}\n  />\n}\n\nexport const SimulatorWrapContext = React.createContext({ mode: \"web\", SuffixFieldDisplay: (props: any) => <></>, SuffixFieldWidth: 84 })\n\nexport const SimulatorWrapLayoutContext = React.createContext({ labelCol: 8, wrapperCol: 16 })\n\nconst SimulatorWrap: React.FC<ISimulatorWrapProps> = (props) => {\n  const { formDesignPerfixCls } = React.useContext(FormDesignRootContext)\n  const SimulatorWrapLayoutContextValue = React.useMemo(() => Object.assign({ labelCol: 8, wrapperCol: 16 }, props.layout), [props.layout])\n\n  const SimulatorWrapContextValue = React.useMemo(() => Object.assign({}, { mode: props.mode || \"web\", SuffixFieldDisplay: (props.SuffixFieldDisplay as any) || (() => <></>) as React.ComponentType, SuffixFieldWidth: props.SuffixFieldWidth || 84 }), [props.SuffixFieldWidth, props.SuffixFieldDisplay, props.mode])\n\n  React.useEffect(() => {\n    expandHandle(props.expendFieldSimulate!)\n  }, [props.expendFieldSimulate])\n\n  return <SimulatorWrapContext.Provider value={SimulatorWrapContextValue}>\n    <SimulatorWrapLayoutContext.Provider value={SimulatorWrapLayoutContextValue}>\n      <div className={`${formDesignPerfixCls}-simulator-content`}>\n        <DropFieldGroupWithContext\n          contentFieldId={null}\n          customNoData={props.noData || <DefaultNoData />}\n        />\n      </div>\n    </SimulatorWrapLayoutContext.Provider>\n  </SimulatorWrapContext.Provider>\n}\n\nexport default SimulatorWrap","import * as React from 'react'\nimport Row from 'antd/lib/row'\nimport { FormDesignRootContext } from '../../basic/context-wrapper'\n\ninterface IProps {\n  title: string\n  supContent: React.ComponentType\n}\n\nexport const FormGroup: React.FC<IProps> = ({ title, supContent: SupContent = () => null, children }) => {\n  const { formDesignPerfixCls } = React.useContext(FormDesignRootContext)\n  return <>\n    <div className={`${formDesignPerfixCls}-form-group-title`}>\n      {title}\n      <SupContent />\n    </div>\n    <Row>\n      {children}\n    </Row>\n  </>\n}\n\nexport const SideLine: React.FC = () => {\n  const { formDesignPerfixCls } = React.useContext(FormDesignRootContext)\n  return <div className={`${formDesignPerfixCls}-side-line`} />\n}\n","import * as React from 'react'\nimport Moment from 'moment'\nimport Input from 'antd/lib/input'\nimport DatePicker from 'antd/lib/date-picker'\nconst { RangePicker: AntdRangePicker } = DatePicker\n\ninterface ICommonProps {\n  type: string\n  value: string[]\n  onChange: (value: string[]) => void\n  decimal?: number\n  suffix?: string\n}\n\n// const percentValue = (type: string, v: string, decimal: number) => type === 'percent' && v ? \"\" + (+v * 100).toFixed(decimal - 2) : v\n\nconst transformValue = (v: string) => {\n  if (/^\\-$/.test(v)) {\n    return \"0\"\n  } else if (/\\.$/.test(v)) {\n    return v.slice(0, v.length - 1)\n  } else {\n    return null\n  }\n}\n\nconst RangeSetterWithInput: React.FC<ICommonProps> = (props) => {\n  const { type, value, onChange, decimal = 2, ...otherProps } = props\n\n  const [cacheValue, setCacheValue] = React.useState(props.value || [])\n\n  const rexExp = React.useMemo(() => new RegExp('^\\\\-?((0|[1-9][0-9]*)?$|(0|[1-9][0-9]*)(\\\\.\\\\d{0,' + decimal + '})?$)'), [decimal])\n\n  const dealWithValue = (index: number, newValue: string) => {\n    const targetValue = [...cacheValue]\n    if (rexExp.test(newValue)) {\n      targetValue[index] = newValue\n      return targetValue\n    } else {\n      return null\n    }\n  }\n\n  const wapperOnChange = (index: number, e: any) => {\n    const newValue = e.target.value\n    const targetValue = dealWithValue(index, newValue)\n    if (targetValue) {\n      const changeValue = [...targetValue]\n      setCacheValue(targetValue)\n      const correctionValue = transformValue(newValue)\n      if (correctionValue) {\n        changeValue[index] = correctionValue\n      }\n      onChange(changeValue)\n    }\n  }\n\n  const onBlur = () => {\n    let [minValue, maxValue] = cacheValue\n    minValue = transformValue(minValue) || minValue\n    maxValue = transformValue(maxValue) || maxValue\n    if (minValue && maxValue && +minValue > +maxValue) {\n      setCacheValue([maxValue, minValue])\n      onChange([maxValue, minValue])\n    }\n  }\n\n\n  return <div className=\"flex\">\n    <Input\n      // value={edit ? cacheValue[0] : percentValue(type, cacheValue[0], decimal)}\n      value={cacheValue[0]}\n      onChange={wapperOnChange.bind(null, 0)}\n      onBlur={onBlur}\n      {...otherProps} />\n    ~\n    <Input\n      // value={edit ? cacheValue[1] : percentValue(type, cacheValue[1], decimal)}\n      value={cacheValue[1]}\n      onChange={wapperOnChange.bind(null, 1)}\n      onBlur={onBlur}\n      {...otherProps} />\n  </div>\n}\n\n\nconst RangePicker: React.FC<ICommonProps & { format?: string }> = (props) => {\n  const { value, onChange, format, ...otherProps } = props\n  const [cacheValue, setCacheValue] = React.useState(Array.from({ length: 2 }, (el: any, i: number) => props.value[i] && Moment(props.value[i])))\n\n  const rangePickerConfig = React.useMemo(() => {\n    const staticConfigs: any = {\n      \"YYYY\": { type: \"rangepicker\", picker: \"year\" },\n      \"YYYY-MM\": { type: \"rangepicker\", picker: \"month\" },\n      \"YYYY-MM-DD HH:mm\": { type: \"rangepicker\", showTime: { format: \"HH:mm\" } },\n      \"YYYY-MM-DD HH:mm:ss\": { type: \"rangepicker\", showTime: { format: \"HH:mm:ss\" } }\n    }\n    const targetConfig = staticConfigs[format!] || { type: \"rangepicker\" }\n    const newValues = value.map((el) => el && Moment(el).format(format))\n    onChange(newValues)\n    setCacheValue(newValues.map((el: any) => el && Moment(el)))\n    return targetConfig\n  }, [format])\n\n  const onInputChange = (dates: any, dateStrings: [string, string]) => {\n    setCacheValue(dates)\n    onChange(dateStrings)\n  }\n\n  return <AntdRangePicker\n    {...otherProps}\n    {...rangePickerConfig}\n    block={true}\n    value={cacheValue}\n    isDefinedValue={true}\n    onCalendarChange={onInputChange}\n  />\n}\n\ninterface IProps {\n  type: \"number\" | \"rangepicker\"\n  onChange: (e: any) => void\n  onFocus: (e: any) => void\n  onBlur: (e: any) => void\n  value: string[]\n  [key: string]: any\n}\n\n// 自定义区间字段\nconst RangeSetter: React.FC<IProps> = ({ type, onBlur, onFocus, ...otherProps }) => {\n  const [RenderComponent] = React.useMemo(() => {\n    return [type === \"rangepicker\" ? RangePicker : RangeSetterWithInput]\n  }, [type])\n\n  return <>\n    <RenderComponent\n      type={type}\n      {...otherProps}\n    />\n  </>\n}\n\nexport default RangeSetter\n// 校验规则\nexport const rangeSetterValidateRules = (validateData: string[], rule: any, ctx: any) => {\n  const [minValue, maxValue] = validateData || []\n  if (!minValue || !maxValue) {\n    return \"该字段是必填字段\"\n  } else {\n    return \"\"\n  }\n}\n\nconst typeTitleMap: any = {\n  \"number\": \"数值\",\n  \"percent\": \"百分比\",\n  \"rangepicker\": \"日期\"\n}\n// 联动规则\nexport const rangeSetterEeactRangeErrorMsg = (field: any) => {\n  const [minValue, maxValue] = field.value || []\n  const fieldTitle = typeTitleMap[field.componentProps.type]\n  const suffix = field.componentProps.suffix || \"\"\n  let newValue = \"\"\n  if (minValue && !maxValue) {\n    newValue = `不能低于${fieldTitle}最小值${minValue}${suffix}`\n  } else if (!minValue && maxValue) {\n    newValue = `不能超出${fieldTitle}最大值${maxValue}${suffix}`\n  } else if (minValue && maxValue) {\n    newValue = `请输入${minValue}${suffix}~${maxValue}${suffix}的${fieldTitle}`\n  }\n  return newValue\n}","import React from 'react'\nimport Radio from 'antd/lib/radio'\nconst RadioGroup = Radio.Group\n\ninterface Iprops {\n    isCompose?: boolean\n    checkText?: string\n    options: string[] | number[] | Array<{ label: string, value: string, disabled?: boolean }>\n}\n\nconst RadioCombination: React.FC<Iprops> = (props) => {\n    const { isCompose, checkText, children, options, ...otherProps } = props\n    return isCompose ?\n        <RadioGroup options={options} {...otherProps} />\n        : <Radio {...otherProps}>\n            {checkText || children}\n        </Radio>\n}\n\nexport default RadioCombination","import * as React from 'react'\nimport { connect, mapProps, JSXComponent } from '@formily/react'\nimport { Field as FieldType, registerValidateRules } from '@formily/core'\nimport { SetterPaneLayoutContext } from '../index'\nimport BaseFormItem from './form-item'\nimport { FormGroup, SideLine } from './void-fields'\nimport RangeSetter, { rangeSetterValidateRules, rangeSetterEeactRangeErrorMsg } from './range-setting'\nimport Input from 'antd/lib/input'\nimport Select from 'antd/lib/select'\nimport InputNumber from 'antd/lib/input-number'\nimport Radio from '../../../radio'\nimport Checkbox from 'antd/lib/checkbox'\nconst { TextArea } = Input\n\nconst isObject = (data: any) => Object.prototype.toString.call(data) === \"[object Object]\";\n// statusType change effects\nconst statusTypeChangeEffect = (statusInfo: any, $self: FieldType, linkageFields: any, alisa: string) => {\n  const $form = $self.form\n  const cacheField = linkageFields[statusInfo.perStatusType || $self.initialValue] || []\n  Object.entries(cacheField).forEach(([key, linkageKeys]: [string, any]) => {\n    linkageKeys = Array.isArray(linkageKeys) ? linkageKeys : [linkageKeys]\n    statusInfo[key] = linkageKeys.reduce((acc: any, next: string) => {\n      const curValue = $form.getValuesIn(next)\n      if (isObject(curValue)) {\n        acc = acc || {}\n        Object.assign(acc, curValue)\n      } else {\n        acc = curValue\n      }\n      return acc\n    }, undefined)\n  })\n  statusInfo.perStatusType = $self.value\n}\n// 默认scope\nexport const createDefaultScope = (fieldInfo: any) => {\n  const statusInfo: any = {}\n  return { rangeSetterEeactRangeErrorMsg, statusTypeChangeEffect: statusTypeChangeEffect.bind(null, statusInfo), statusInfo }\n}\n// 默认注册规则 \nregisterValidateRules({ rangeSetterValidateRules })\n\ntype IStateMapper<Props> = {\n  [key in keyof FieldType]?: keyof Props | boolean;\n} | ((props: Props, field: any) => Props);\n\nconst FormItem = React.memo((props) => {\n  const layout = React.useContext(SetterPaneLayoutContext)\n  return <BaseFormItem {...layout} {...props} />\n})\n\nconst WrapperComponent = <T extends JSXComponent>(supInfo: any, InnerComponent: T, ...mapPropsParams: Array<IStateMapper<React.ComponentProps<T>>>) => {\n\n  if (mapPropsParams.length) {\n    const func = mapPropsParams[mapPropsParams.length - 1]\n    if (typeof func === \"function\") {\n      mapPropsParams[mapPropsParams.length - 1] = (props, field) => {\n        const result = supInfo.dealWithCustomData?.(props, field)\n        return ({ ...func(result, field), ...result })\n      } \n    }\n  } else {\n    mapPropsParams = [(props, field) => supInfo.dealWithCustomData?.(field.data || {}, props)]\n  }\n  return connect(InnerComponent, mapProps(...mapPropsParams))\n}\n\nexport const expandField = (supInfo: any = {}, originData: { [key: string]: React.ComponentType }) => {\n  //@ts-ignore\n  const WrapperComponentBindSupInfo: <T extends JSXComponent>(InnerComponent: T, ...mapPropsParams: Array<IStateMapper<React.ComponentProps<T>>>) => T = WrapperComponent.bind(null, supInfo)\n\n  if (originData && isObject(originData)) {\n    return Object.entries(originData).reduce((acc: any, [key, element]) => {\n      acc[key] = WrapperComponentBindSupInfo(element)\n      return acc\n    }, {})\n  }\n  return {}\n}\n\nconst createCommonField = (supInfo: any = {}, formDesignPerfixCls: string) => {\n  //@ts-ignore\n  const WrapperComponentBindSupInfo: <T extends JSXComponent>(InnerComponent: T, ...mapPropsParams: Array<IStateMapper<React.ComponentProps<T>>>) => T = WrapperComponent.bind(null, supInfo)\n\n  const InputWithFormily = WrapperComponentBindSupInfo(Input)\n\n  const SelectWithFormily = WrapperComponentBindSupInfo(({ id, ...props }) => <div id={id}><Select {...props} /></div>, (props, field): any => {\n    const id = formDesignPerfixCls + \"-\" + field.address.entire\n    return { options: field.dataSource, id, getPopupContainer: () => document.getElementById(id) }\n  })\n\n  const InputNumberWithFormily = WrapperComponentBindSupInfo(({ correctionNumber, ...props }) => <InputNumber {...props} />, (props: any): any => {\n    const correctionNumber = props.correctionNumber\n    const baseConfig = { className: 'input-number-handler-wrap-contorl' }\n    return correctionNumber ? {\n      ...baseConfig,\n      formatter: (v: string) => +v - correctionNumber, parser: (v: string) => +v + correctionNumber\n    } : baseConfig\n  })\n\n  const RadioWithFormily = WrapperComponentBindSupInfo(Radio, (props: any, field): any => props.isCompose && { options: field.dataSource })\n\n  const CheckboxWithFormily = WrapperComponentBindSupInfo(Checkbox, { value: \"checked\" }, (props: any, field): any => props.isCompose ? {} : { composeOpts: field.dataSource, checkedOpts: props.value })\n\n  const TextAreaWithFormily = WrapperComponentBindSupInfo(TextArea)\n\n  const RangeSetterWithFormily = WrapperComponentBindSupInfo(RangeSetter)\n\n  const FormGroupWithFormily = connect(FormGroup)\n\n  const SideLineWithFormily = connect(SideLine)\n  return {\n    Input: InputWithFormily,\n    TextArea: TextAreaWithFormily,\n    Select: SelectWithFormily,\n    InputNumber: InputNumberWithFormily,\n    Radio: RadioWithFormily,\n    Checkbox: CheckboxWithFormily,\n    FormGroup: FormGroupWithFormily,\n    RangeSetter: RangeSetterWithFormily,\n    SideLine: SideLineWithFormily,\n    FormItem\n  }\n}\n\nexport default createCommonField","import * as React from 'react'\nimport { createForm, Form, onFormInputChange, registerValidateRules, onFieldInputValueChange, onFormMount, Field } from '@formily/core'\nimport { createSchemaField, FormProvider } from '@formily/react'\nimport { observable, reaction } from '@formily/reactive'\nimport scrollIntoView from 'scroll-into-view-if-needed'\nimport createCommonField, { expandField, createDefaultScope } from './register-field'\nimport { FormDesignSupInfo, mapSchema } from '../basic/common'\nimport { FormDesignDataContext, FormDesignRootContext } from \"../basic/context-wrapper\"\nimport './style.less'\nimport { ISetterPaneInteralProps, ISetterPaneOuterProps } from '../module'\n\nconst resetSetterPaneSchema = observable.ref(0)\nconst resetSetterPaneValue = observable.ref(0)\n\nconst validateWithScroll = (form: Form) => {\n  form.validate().catch(\n    ((j: any) => {\n      scrollIntoView(document.getElementById(j[0].address) as HTMLElement, {\n        scrollMode: \"if-needed\",\n        block: 'nearest',\n        inline: 'nearest',\n        behavior: \"smooth\"\n      })\n    })\n  )\n}\n\nconst DefaultNoData = () => {\n  return <div style={{height:'100%',display:'flex',alignItems:\"center\",justifyContent:\"center\"}}>请选择需要设置的组件</div>\n}\n\nconst useFormCoreData = (selectedFieldId: string, fieldsMap: any, supInfo: any, changeField: any) => {\n  const fieldInfo = fieldsMap[selectedFieldId] || {}\n  const type = fieldInfo?.type\n  const [formCore, setFormCore] = React.useState<[any, Form | null]>([{ type: \"object\", properties: {} }, null])\n  const [cacheCite] = React.useState<any>({ selectedFieldId: null })\n  const createSchema = React.useCallback((schemaType, curSupInfo, controlFieldsKey: string[] = []) => {\n    if (!cacheCite.selectedFieldId || !fieldsMap[cacheCite.selectedFieldId]) {\n      return { type: \"object\", properties: {} }\n    }\n    const curFieldInfo = curSupInfo.recoverField(cacheCite.formAction.values)\n    return mapSchema(curSupInfo.fieldSetterTemplate[schemaType], (key, item, basePath) => {\n      if (item.type || item['x-component']) {\n        controlFieldsKey.push(basePath.concat(key).toString())\n        const contorlParams = { componentProps: item['x-component-props'], enum: item.enum, visible: item[\"x-visible\"] }\n        const result = curSupInfo.manualContorlSchema?.(key, contorlParams, curFieldInfo)\n        if (result && result !== contorlParams) {\n          if (result.enum && Array.isArray(result.enum)) {\n            item.enum = result.enum\n          }\n          if (result.componentProps) {\n            item['x-component-props'] = result.componentProps\n          }\n          if (typeof result.visible === \"boolean\") {\n            item['x-visible'] = result.visible\n          }\n        }\n      }\n    })\n  }, [])\n\n  const createFormAction = React.useCallback((initialValues, curSupInfo) => createForm({\n    initialValues,\n    validateFirst: true,\n    effects: () => {\n      onFormMount((f) => {\n        if (curSupInfo.validateWithScrollSign.value === cacheCite.selectedFieldId) {\n          curSupInfo.validateWithScrollSign.value = \"\"\n          validateWithScroll(f)\n        }\n      })\n      onFieldInputValueChange(\"*\", (field) => {\n        curSupInfo.onFieldChange(field.props.name, field.value)\n      })\n      onFormInputChange((f) => {\n        changeField(cacheCite.selectedFieldId, f.values)\n      })\n    },\n  }), [changeField])\n\n  React.useEffect(() => {\n    if (supInfo) {\n      reaction(() => supInfo.resetSetterPaneSchema.value, () => {\n        const controlFieldsKey: string[] = []\n        const newSchema = createSchema(cacheCite.type, cacheCite.supInfo, controlFieldsKey)\n        cacheCite.formAction.setFormState((f: any) => {\n          controlFieldsKey.forEach((key) => {\n            delete f.fields[key]\n          })\n          setFormCore([newSchema, cacheCite.formAction])\n        })\n      }, {\n        fireImmediately: false\n      })\n    }\n  }, [supInfo])\n\n  React.useEffect(() => {\n    if (supInfo) {\n      cacheCite.selectedFieldId = selectedFieldId\n      cacheCite.type = type\n      cacheCite.supInfo = supInfo\n      const newFormAction = createFormAction(fieldInfo, supInfo)\n      cacheCite.formAction = newFormAction\n      const newSchema = createSchema(type, supInfo)\n      setFormCore([newSchema, newFormAction])\n    }\n  }, [selectedFieldId, type, supInfo])\n\n  return formCore\n}\n\nconst SetterPane: React.FC<ISetterPaneInteralProps> = React.memo(({ createSchemaFieldParams, selectedFieldId, fieldType, fieldsMap, NoData = DefaultNoData, changeField, formDesignId }) => {\n  const fieldInfo = fieldsMap[selectedFieldId] || {}\n\n  const supInfo = FormDesignSupInfo[formDesignId]\n\n  const [fakeThisAttr] = React.useState<{ form: any, selectedFieldId: string }>({ form: {}, selectedFieldId })\n\n  const [schema, formAction] = useFormCoreData(selectedFieldId, fieldsMap, supInfo, changeField)\n\n  const FieldSchemaField = React.useMemo(() => {\n    Object.assign(createSchemaFieldParams.scope, createDefaultScope(fieldInfo))\n    createSchemaFieldParams.scope.$published = fieldInfo.published || false\n    return createSchemaField(createSchemaFieldParams)\n  }, [createSchemaFieldParams, schema])\n\n\n  React.useEffect(() => {\n    fakeThisAttr.form = formAction\n    fakeThisAttr.selectedFieldId = selectedFieldId\n  }, [formAction])\n\n  React.useEffect(() => {\n    if (supInfo) {\n      reaction(() => supInfo.validateWithScrollSign.value, (newValue) => {\n        if (newValue === fakeThisAttr.selectedFieldId) {\n          supInfo.validateWithScrollSign.value = \"\"\n          validateWithScroll(fakeThisAttr.form)\n        }\n      })\n      // value need change\n      reaction(() => supInfo.resetSetterPaneValue.value, (newValue, oldValue) => {\n        if (fakeThisAttr.form?.id) {\n          fakeThisAttr.form.setValues(fieldsMap[fakeThisAttr.selectedFieldId], \"overwrite\")\n        }\n      }, {\n        fireImmediately: false\n      })\n    }\n\n  }, [supInfo])\n\n  return <>\n    {fieldType && formAction ?\n      <FormProvider form={formAction}>\n        <FieldSchemaField schema={schema} />\n      </FormProvider>\n      : <NoData />}\n  </>\n}, (pp, np) => {\n  return pp.selectedFieldId === np.selectedFieldId && pp.fieldType === np.fieldType && pp.changeField === np.changeField && pp.createSchemaFieldParams === np.createSchemaFieldParams\n})\n\nexport const SetterPaneLayoutContext = React.createContext({\n  labelCol: 8,\n  wrapperCol: 16,\n  span: 24\n})\n\nconst SetterPaneWithContext: React.FC<ISetterPaneOuterProps> = (props) => {\n  const { expandFields = {}, layout = {}, scope, ...otherProps } = props\n  const { formDesignPerfixCls } = React.useContext(FormDesignRootContext)\n  const { selectedFieldId, fieldsMap, formDesignId, changeField } = React.useContext(FormDesignDataContext)\n\n  const supInfo = FormDesignSupInfo[formDesignId]\n\n  const createSchemaFieldParams = React.useMemo(() => {\n    const options = {\n      components: { ...createCommonField(supInfo,formDesignPerfixCls!), ...expandField(supInfo, expandFields) },\n      scope: {\n        typeEffect(field: Field) {\n          const { value } = field\n          const { title, description, inheritCode, tips, isNew, id, parId } = field.form.values || {}\n          const base = typeof isNew === 'boolean' ? { isNew } : {}\n          const { splitDownKeys, ...template } = (supInfo.fieldInfoTemplate || {})[value]\n          const newValue = { ...base, ...template, title, description, inheritCode, tips, id, parId }\n          changeField(\"\", newValue, true)\n        },\n        customScope: scope\n      }\n    }\n    // 缓存到supInfo\n    FormDesignSupInfo.changeSupInfo(formDesignId, { createSchemaFieldParams: options, resetSetterPaneSchema, resetSetterPaneValue })\n    return options\n  }, [expandFields, scope, supInfo])\n\n  React.useEffect(() => {\n    // 注册自定义检验规则\n    registerValidateRules({\n      customFieldsRules: (v, r, c) => {\n        const curfieldInfo = supInfo.recoverField?.(c.form.values);\n        return supInfo.customFieldsRules?.(curfieldInfo, c?.props?.name, v)\n      }\n    })\n  }, [supInfo])\n\n  const SetterPaneLayoutContextValue = React.useMemo(() => Object.assign({\n    labelCol: 8,\n    wrapperCol: 16,\n    span: 24\n  }, layout), [layout])\n\n  const fieldType = fieldsMap[selectedFieldId || \"\"]?.type\n\n  return <SetterPaneLayoutContext.Provider value={SetterPaneLayoutContextValue}>\n    <SetterPane\n      {...otherProps}\n      formDesignId={formDesignId}\n      selectedFieldId={selectedFieldId || \"\"}\n      fieldsMap={fieldsMap}\n      fieldType={fieldType}\n      createSchemaFieldParams={createSchemaFieldParams}\n      changeField={changeField}\n    />\n  </SetterPaneLayoutContext.Provider>\n}\nexport default SetterPaneWithContext","import React from 'react'\n// import cs from 'classnames'\nimport { useDragLayer } from 'react-dnd'\nimport { FormDesignSupInfo } from './common'\n\nconst layerStyles: React.CSSProperties = {\n  position: \"fixed\",\n  pointerEvents: \"none\",\n  zIndex: -1,\n  left: 0,\n  top: 0,\n  height: \"0px\",\n  visibility: \"hidden\"\n};\n\nfunction getItemStyles(currentOffset: any, clientOffset: any, { contentHeight, contentWidth }: { contentHeight: number, contentWidth: number }, fieldId: string): any {\n  if (!currentOffset || !clientOffset) {\n    return {}\n  }\n  const { x: currentX, y: currentY } = currentOffset;\n  const { x: clientX, y: clientY } = clientOffset\n  const targetStyle: any = {\n    background: \"#fff\",\n    position: \"relative\",\n    left: `${currentX}px`,\n    top: `${currentY}px`,\n    // height: `${contentHeight}px`,\n    // width: `${contentWidth}px`\n  }\n  if (fieldId) {\n    Object.assign(targetStyle, {\n      transform: 'translate(-50%, -50%)',\n      left: `${clientX}px`,\n      top: `${clientY}px`\n    })\n    // targetStyle.transform = 'translate(-50%, -50%)'\n    // targetStyle.left = `${clientX}px`,\n    //   targetStyle.top = `${clientY}px`\n  }\n\n  return targetStyle\n}\n\nconst DragPerview: React.FC<any> = ({ formDesignId, fieldsMap, formDesignPerfixCls }) => {\n  const { dndMaskLayerTemplates, CoustomPerView } = FormDesignSupInfo[formDesignId] || {}\n  const {\n    isDragging,\n    dragItem,\n    currentOffset,//当前dragSource拖动之后的坐标距离页面左上角的偏移\n    clientOffset,//当前鼠标的坐标（即在dragSource上点击的位置在拖动之后的坐标）距离页面的左上角的偏移\n  } = useDragLayer(monitor => ({\n    dragItem: monitor.getItem(),\n    currentOffset: monitor.getSourceClientOffset(),\n    clientOffset: monitor.getClientOffset(),\n    isDragging: monitor.isDragging()\n  }))\n  const [item, customPerviewProps] = React.useMemo(() => {\n    if (dragItem?.id) {\n      const { type: uniquelySign, title: fieldName } = fieldsMap[dragItem.id]\n      const { id: dragId, iconClass } = dndMaskLayerTemplates[uniquelySign] || {}\n      const targetData = { ...dragItem, uniquelySign, fieldName, iconClass, }\n      return [{ ...targetData, dragId }, targetData]\n    } else if (dragItem?.uniquelySign) {\n      const { iconClass, id: dragId, name } = dndMaskLayerTemplates[dragItem?.uniquelySign]\n      const targetData = { ...dragItem, iconClass, fieldName: name }\n      return [{ ...targetData, dragId }, targetData]\n    } else {\n      return [dragItem, dragItem]\n    }\n  }, [dragItem, fieldsMap, dndMaskLayerTemplates])\n\n  const [fakeThisAttr] = React.useState({ contentHeight: 40, contentWidth: 0 })\n\n  React.useEffect(() => {\n    if (item) {\n      const domId = item.dragId || (Object.values(dndMaskLayerTemplates)[0] as any)?.id\n      const contentWidth = document.getElementById(domId)?.offsetWidth\n      fakeThisAttr.contentWidth = contentWidth || 200\n    }\n  }, [item])\n\n  const postionStyle = getItemStyles(currentOffset, clientOffset, fakeThisAttr, item?.id)\n  // const iconType = item?.iconClass\n  return <>\n    <div style={isDragging && item?.uniquelySign ? { ...layerStyles, zIndex: 999, visibility: \"visible\" } : layerStyles}>\n      <div style={postionStyle}>\n        {CoustomPerView ? <CoustomPerView {...customPerviewProps} /> : <div className={`${formDesignPerfixCls}-drag-perview`} style={{ width: fakeThisAttr.contentWidth, height: fakeThisAttr.contentHeight }}>\n          {/* {iconType && <IrsBaseIcon className={`${formDesignPerfixCls}-single-widget-icon`} type={iconType} />} */}\n          <div className={`${formDesignPerfixCls}-single-widget-text`}>\n            {item?.fieldName}\n          </div>\n        </div>}\n      </div>\n    </div>\n    <div id={`${formDesignPerfixCls}-faker-perview`} style={{ position: 'fixed', top: \"-1000px\" }}>&nbsp;</div>\n  </>\n}\n\nexport default DragPerview","import * as React from 'react'\nimport cs from 'classnames'\nimport { DndProvider } from 'react-dnd'\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { validate, submit, getFieldsMap, FormDesignSupInfo } from './common'\nimport { FormDesignProviderWrapper, FormDesignDataContext, FieldOperationsContext, FormDesignRootContext } from './context-wrapper'\nimport DragPerview from './perview'\nimport * as constants from '../constants'\nimport './index.less'\nimport { IFormDesignProps } from '../module';\n\n\nconst FormDesignProvider: React.FC<IFormDesignProps> = React.forwardRef((props, ref) => {\n  const rootState = React.useContext(FormDesignRootContext)\n  const dataState = React.useContext(FormDesignDataContext)\n  const operationFuncs = React.useContext(FieldOperationsContext)\n  const canRender = React.useMemo(() => FormDesignSupInfo[dataState.formDesignId]?.mounted, [dataState.formDesignId])\n  React.useImperativeHandle(ref, () => {\n    const supInfo = FormDesignSupInfo[dataState.formDesignId] || {}\n    const { recoverField, resetSetterPaneSchema, resetSetterPaneValue } = supInfo\n    /** \n     * add field \n     */\n    const addField = (uniquelySign: string, depandFieldId: string | null = dataState.selectedFieldId, noValidate: boolean = true) => {\n      const dragFieldInfo = { type: constants.BASE, uniquelySign }\n      const depandField = dataState.fieldsMap[depandFieldId || \"\"]\n      let placeLayerInfo: any = {\n        contentFieldId: null,\n        dropIndex: null,\n        id: \"\",\n        type: \"BASE\"\n      }\n      if (depandField) {\n        const contentFieldId = depandField.parId\n        const operationContent = contentFieldId ? (dataState.nestedFieldPostions[contentFieldId] || []) : dataState.outerFieldPostions\n        let dropIndex = operationContent.findIndex((el: any) => el.id === depandFieldId)\n        dropIndex = dropIndex > -1 ? dropIndex + 1 : operationContent.length\n        placeLayerInfo = {\n          contentFieldId,\n          dropIndex,\n          id: depandFieldId,\n          type: \"BASE\"\n        }\n      }\n      return operationFuncs.placeField(placeLayerInfo, dragFieldInfo, noValidate)\n    }\n    /**\n     * delete fields \n     */\n    const deleteField = (deleteFieldId: string | string[], noValidate: boolean = true) => {\n      const params: [string | string[], string | null, number | null] = [deleteFieldId, null, null]\n      if (typeof deleteFieldId === \"string\") {\n        const contentFieldId = dataState.fieldsMap[deleteFieldId]?.parId || null\n        // const operationContent = contentFieldId ? (state.nestedFieldPostions[contentFieldId] || []) : state.outerFieldPostions\n        // let deleteIndex = operationContent.findIndex((el: any) => el.id === deleteFieldId)\n        // deleteIndex = deleteIndex > -1 ? deleteIndex + 1 : operationContent.length\n        params[1] = contentFieldId\n        // params[2] = deleteIndex\n      }\n      return operationFuncs.deleteField(...params, null, noValidate)\n    }\n    // 获取当前选中字段id\n    const getSelectFieldId = () => dataState.selectedFieldId\n\n    const resetSetterPane = () => {\n      resetSetterPaneValue.value = resetSetterPaneValue.value + 1\n      resetSetterPaneSchema.value = resetSetterPaneSchema.value + 1\n    }\n\n    const changeFieldInfo = (fieldId: string, newField: any, cover?: boolean) => {\n      if (fieldId) {\n        const { outerFieldPostions, nestedFieldPostions, fieldsMap } = dataState\n        const parId = fieldsMap[fieldId]?.parId\n        const { visible } = (parId ? nestedFieldPostions[parId] : outerFieldPostions).filter((el: any) => el.id === fieldId)[0] || {}\n        newField = visible ? supInfo.transformField(newField) : newField\n      }\n      dataState.changeField(fieldId, newField, cover || false)\n      if (!fieldId || fieldId === dataState.selectedFieldId) {\n        resetSetterPaneValue.value = resetSetterPaneValue.value + 1\n      }\n    }\n\n    const getSelectField = () => recoverField(dataState.fieldsMap[dataState.selectedFieldId || \"\"])\n\n    const scrollToErrorParams = (rejectPromise: any) => {\n      let firstErrorFlieldId = \"\"\n      return rejectPromise.catch((j: any[]) => {\n        const [[key]]: Array<[string, any]> = Object.entries(j[0])\n        firstErrorFlieldId = key\n        throw j\n      }).finally(() => {\n        if (firstErrorFlieldId) {\n          operationFuncs.selectField?.(firstErrorFlieldId)\n          supInfo.validateWithScrollSign.value = firstErrorFlieldId\n        }\n      })\n    }\n\n    return {\n      validate: () => scrollToErrorParams(validate(dataState, supInfo)),\n      submit: () => scrollToErrorParams(submit(dataState, supInfo)),\n      getFieldsMap: getFieldsMap.bind(null, dataState, recoverField),\n      setSelectFieldId: operationFuncs.selectField,\n      getSelectFieldId,\n      getSelectField,\n      deleteField,\n      addField,\n      changeFieldInfo,\n      resetSetterPane\n    }\n  }, [dataState, operationFuncs])\n\n  return <DndProvider backend={HTML5Backend}>\n    <div className={cs(rootState.formDesignPerfixCls, props.className)} style={props.style}>\n      {canRender && props.children}\n    </div>\n    <DragPerview\n      formDesignPerfixCls={rootState.formDesignPerfixCls}\n      formDesignId={dataState.formDesignId}\n      fieldsMap={dataState.fieldsMap}\n    />\n  </DndProvider>\n})\n\nexport default FormDesignProviderWrapper(React.memo(FormDesignProvider))","import React from \"react\";\ninterface IProps {\n  prefix?: string;\n}\nconst rootContext = React.createContext<IProps>({});\nconst formDesignContext = React.createContext<any>({});\nexport { rootContext, formDesignContext };\n","import {createFromIconfontCN} from '@ant-design/icons'\n\nconst Icon = createFromIconfontCN({\n    scriptUrl:\"//at.alicdn.com/t/font_3381042_a6bd1m4mp6u.js\"\n})\n\nexport default Icon","import React from 'react'\nimport {rootContext} from './context'\nimport Icon from '../../components/icon'\nimport { Button, Space } from 'antd'\ninterface IButtonGroupProps {\n    dataSource: any[]\n    buttonSize?: 'small' | 'middle' | 'large'\n    size?: 'small' | 'middle' | 'large' | number\n    onChange?: (sign: string) => any\n}\nconst ButtonGroup: React.FC<IButtonGroupProps> = React.memo(({ onChange, dataSource, size, buttonSize }) => {\n    const [selectId, setSelectId] = React.useState(0)\n    const onClick = (id: number, sign: string) => {\n        setSelectId(id)\n        onChange?.(sign)\n    }\n    return <Space size={size || 0}>\n        {\n            dataSource.map(({ children, sign, ...props }, i) => <Button\n                size={buttonSize}\n                key={sign}\n                {...props}\n                style={i === selectId ? { cursor: \"default\" } : {}}\n                disabled={i === selectId}\n                onClick={onClick.bind(null, i, sign)}\n            >\n                {children}\n            </Button>)\n        }\n    </Space>\n})\n\ninterface IProps {\n    onChange: (sign: string) => void\n}\n\nconst ContentHeader: React.FC<IProps> = ({ onChange }) => {\n    const { prefix } = React.useContext(rootContext)\n\n    return <div className={`flex ${prefix}-content-header`}>\n        <ButtonGroup\n            buttonSize='small'\n            dataSource={[{ children: <Icon type=\"icon-design\" />, sign: 'design' }, { children: <Icon type=\"icon-json\" />, sign: \"json\" }]}\n            onChange={onChange}\n        />\n    </div>\n}\n\nexport default ContentHeader","import React from 'react'\nimport { Layout, Input, Select } from 'antd'\nimport { Drag, SimulatorWrap, SetterPane } from '../../components/formily'\nimport { rootContext, formDesignContext } from './context'\nimport ContentHeader from './content-header'\nconst { Content, Sider } = Layout\nconst { TextArea } = Input\nconst expandFields = {\n    CustomDataSourceSetter: Input,\n    AssociateDataSourceSetter: () => \"AssociateDataSourceSetter\",\n    NonEditableInfoSetter: (props: any) => <Select options={[{ key: \"1\", value: \"1\" }, { key: \"2\", value: \"2\" }]} {...props} />,\n}\ninterface IDragGroupProps {\n    dataSource: Array<{ name: string, uniquelySign: string }>\n}\n\nconst DragGroup: React.FC<IDragGroupProps> = ({ dataSource }) => {\n    return <div style={{ display: \"flex\", flexDirection: \"column\", padding: \"8px 16px\" }}>\n        {dataSource.map((el: any) => {\n            return <Drag key={el.uniquelySign} uniquelySign={el.uniquelySign} info={el} style={{ marginBottom: \"8px\" }} />\n        })}\n    </div>\n}\n\n\nconst reducer = (state: any, actions: any) => {\n    switch (actions.type) {\n        case 'json':\n            return { ...state, showSetterPane: false, showSimulatorWrap: false, json: actions.json }\n        case 'design':\n            return { ...state, showSetterPane: true, showSimulatorWrap: true }\n        default:\n            return state\n    }\n}\n\nconst defaultState = {\n    showSimulatorWrap: true,\n    showSetterPane: true,\n    json: {}\n}\n\nconst ContentMain: React.FC<IDragGroupProps> = ({ dataSource }) => {\n    const { formDesignRef } = React.useContext(formDesignContext)\n    const { prefix } = React.useContext(rootContext)\n    const [{ showSetterPane, showSimulatorWrap, json }, dispatch] = React.useReducer(reducer, { ...defaultState })\n\n    const onChange = React.useCallback((sign) => {\n        const task = sign === 'json' ? formDesignRef.current.submit() : Promise.resolve()\n        task.then((result: any) => {\n            dispatch({ type: sign, [sign]: result })\n        })\n    }, [])\n\n    return <Layout style={{ height: \"100%\" }}>\n        <Sider theme=\"light\" width={300}>\n            <DragGroup dataSource={dataSource} />\n        </Sider>\n        <Content className={`flex ${prefix}-content-main`}   >\n            <ContentHeader onChange={onChange} />\n            <div className={`${prefix}-operation-content`}>\n                {showSimulatorWrap && <SimulatorWrap />}\n                {!showSimulatorWrap && <div className={`${prefix}-json-show`}>\n                    <TextArea\n                        className={`${prefix}-json-show-main`}\n                        value={JSON.stringify(json, undefined, '\\t')}\n                        bordered={false}\n                        autoSize={true}\n                    />\n                </div>}\n            </div>\n        </Content>\n        {showSetterPane && <Sider theme=\"light\" width={360} style={{ padding: \"8px 16px\", height: \"100%\", overflow: \"overlay\" }} >\n            <SetterPane\n                expandFields={expandFields}\n            />\n        </Sider>}\n    </Layout>\n}\nexport default ContentMain","import * as React from 'react'\nimport { uniqueId } from 'lodash'\nimport { FormDesignProvider, } from '../../components/formily'\n//@ts-ignore\nimport { Layout, } from 'antd'\nimport { IFormDesignRef } from '../../components/formily/module'\nimport ContentMain from './content-main'\nimport './index.less'\nimport {rootContext,formDesignContext} from './context'\nconst textSchema = require('./field-json/text.json')\nconst textareaSchema = require('./field-json/textarea.json')\nconst dateSchema = require('./field-json/date.json')\nconst numberSchema = require('./field-json/number.json')\nconst radioSchema = require('./field-json/radio.json')\n\n\n\nconst templates = [\n  { TEXT: textSchema },\n  { TEXTAREA: textareaSchema },\n  { DATE: dateSchema },\n  { NUMBER: numberSchema },\n  { RADIO: radioSchema }\n]\n\nconst dataSource = [{\n  name: \"文本\",\n  uniquelySign: \"TEXT\",\n}, {\n  name: \"文本域\",\n  uniquelySign: \"TEXTAREA\",\n}, {\n  name: \"日期\",\n  uniquelySign: \"DATE\",\n}, {\n  name: \"数值\",\n  uniquelySign: \"NUMBER\",\n}, {\n  name: \"单选\",\n  uniquelySign: \"RADIO\",\n}]\n\n\n// const CustomArea = (count: any, { fieldInfo }: any) => {\n//   const statusInfo = fieldInfo.statusInfo || {}\n//   return <>{`statusInfo>statusType:`}{statusInfo['statusType']}<br />\n//     {`statusInfo>readonlyInfo:`}{statusInfo['readonlyInfo']}<br />\n//     {`statusInfo>hiddenInfo:`}{statusInfo['hiddenInfo']}\n//   </>\n// }\n\n\n\n// const fakeAttr = { reset: 0 }\nconst Main: React.FC<any> = () => {\n  const formDesignRef = React.useRef<IFormDesignRef>({} as IFormDesignRef)\n  //@ts-ignore\n  const [formVo, setFormVo] = React.useState([])\n\n  const [curTemplates, setCurTemplates] = React.useState<any[]>([])\n\n  React.useEffect(() => {\n    setCurTemplates(templates)\n  }, [])\n\n\n  const createInnerFieldInfo = (field: any) => {\n    const inheritCode = uniqueId(`A-${Math.random().toString(36).slice(-8)}-`)\n    return { ...field, inheritCode }\n  }\n\n  const createCopyFieldInfo = (copyTemplate: any) => {\n    const inheritCode = uniqueId(`a-${Math.random().toString(36).slice(-8)}-`)\n    return { ...copyTemplate, inheritCode }\n  }\n\n\n  return <>\n    <Layout style={{ height: \"100%\", borderBottom: \"1px solid #d9d9d9\" }}>\n      {/* <Header style={{ background: \"#fff\", borderBottom: \"1px solid #d9d9d9\" }}>\n      </Header> */}\n      <formDesignContext.Provider value={{ formDesignRef }}>\n        <FormDesignProvider\n          templates={curTemplates}\n          style={{ flex: 1, overflow: \"hidden\" }}\n          ref={formDesignRef}\n          formVo={formVo}\n          createInnerFieldInfo={createInnerFieldInfo}\n          createCopyFieldInfo={createCopyFieldInfo}\n          fieldKey=\"inheritCode\"\n        // fieldFunctionContorl={fieldFunctionContorl}\n        // customFieldsRules={customFieldsRules}\n        // deleteFieldValidate={deleteFieldValidate}\n        // manualContorlSchema={manualContorlSchema}\n        // onFormVoChange={onFormVoChange}\n        // onFieldChange={onFieldChange}\n        // onChangeValidateInSetter={onChangeValidateInSetter}\n        // extendMaskLayers={{\n        //   SA_STAFF_NO: { name: \"工号\", iconClass: \"icon-file-copy\", uniquelySign: \"SA_STAFF_NO\" }\n        // }}\n        >\n          <ContentMain dataSource={dataSource} />\n        </FormDesignProvider>\n      </formDesignContext.Provider>\n    </Layout>\n  </>\n}\n\nconst contextValue = {\n  prefix: 'custom-form'\n}\n\nconst Page: React.FC = () => {\n  return <rootContext.Provider value={contextValue}>\n    <Main />\n  </rootContext.Provider>\n}\n\nexport default Page;\n\n  // const fakerUnquiely = (fieldsMap: any) => {\n  //   setCount(count + 1)\n  // }\n\n  // const changeSetterPaneLayout = () => {\n  //   const newLayout = layout.labelCol === 24 ? { span: 24, labelCol: 8, wrapperCol: 16 } : { span: 12 }\n  //   setLayout(newLayout)\n  // }\n\n  // const validate = () => {\n  //   formDesignRef.current.validate().then((validatorResult: any) => {\n  //     console.log(validatorResult);\n  //   })\n  // }\n\n\n\n\n  // const setFormVoHandle = () => {\n  //   setFormVo(JSON.parse(sessionStorage.getItem(\"perFormVo\") || \"[]\"))\n  // }\n\n// const customFieldsRules = (f: any, key: any, v: any) => {\n//   console.log(f, key, v);\n//   // if (key === \"statusInfo>editableInfo>customInfo\") {\n//   //   return v === \"123\" ? \"custom error\" : \"\"\n//   // }\n//   return \"\"\n// }\n\n// const fieldFunctionContorl = (el: any) => {\n//   const obj = {\n//     canDrag: true,\n//     canDel: true,\n//     canCopy: true,\n//     visible: !el.hidden\n//   }\n//   return obj;\n// }\n\n// const deleteFieldValidate = (operationField: any) => {\n//   return [operationField.id]\n// }\n\n// const changeFieldInfo = () => {\n//   formDesignRef.current.changeFieldInfo(\"\", { title: \"111\" })\n// }\n\n\n// const onFormVoChange = (type: string) => {\n//   // console.log(type);\n// }\n\n// const onFieldChange = (key: any, value: any) => {\n//   // console.log(key, value);\n// }\n\n// const resetSetterPane = () => {\n//   ++fakeAttr.reset\n//   formDesignRef.current.resetSetterPane()\n// }\n\n// const getSelectField = () => {\n//   const result = formDesignRef.current.getSelectField()\n//   console.log(result);\n// }\n\n// const onChangeValidateInSetter = (...params: any) => {\n//   return true\n// }\n// const getFieldsMap = () => {\n//   console.log(formDesignRef.current.getFieldsMap());\n// }"],"sourceRoot":""}